<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 10.2 - NCHS Cybersecurity</title>
    
    
    <link rel="icon" href="../../../img/logo.png">
    
    
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Orbitron:wght@700;900&display=swap" rel="stylesheet">
    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DRPQMPQQS6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-DRPQMPQQS6');
    </script>
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0e27;
            --bg-secondary: #141b3a;
            --text-primary: #00ff41;
            --text-secondary: #7affa7;
            --text-muted: #4a9960;
            --accent: #ff0844;
            --accent-secondary: #00d4ff;
            --border: #1a3a2a;
        }

        body {
            font-family: 'JetBrains Mono', monospace;
            background: var(--bg-primary);
            color: var(--text-secondary);
            line-height: 1.6;
            min-height: 100vh;
        }

        /* Navigation */
        nav {
            background: var(--bg-secondary);
            border-bottom: 2px solid var(--text-primary);
            padding: 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(0, 255, 65, 0.2);
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 30px;
        }

        .nav-logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .nav-logo img {
            height: 40px;
            width: auto;
        }

        .nav-logo a {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            font-weight: 900;
            color: var(--text-primary);
            text-decoration: none;
            letter-spacing: 0.1em;
            text-shadow: 0 0 10px var(--text-primary);
        }

        .nav-links {
            display: flex;
            gap: 30px;
            list-style: none;
            align-items: center;
        }

        .nav-links > li {
            position: relative;
        }

        .nav-links a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            padding: 8px 15px;
            border-radius: 4px;
            display: block;
        }

        .nav-links a:hover,
        .nav-links a.active {
            color: var(--text-primary);
            background: rgba(0, 255, 65, 0.1);
            text-shadow: 0 0 10px var(--text-primary);
        }

        /* Dropdown menu */
        .nav-links .dropdown {
            position: relative;
        }

        .nav-links .dropdown > a::after {
            content: ' ‚ñº';
            font-size: 0.7em;
            margin-left: 5px;
        }

        .nav-links .dropdown-content {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background: var(--bg-secondary);
            border: 2px solid var(--text-primary);
            border-radius: 4px;
            min-width: 250px;
            box-shadow: 0 8px 30px rgba(0, 255, 65, 0.3);
            z-index: 1000;
            padding: 10px 0;
            margin-top: 5px;
        }

        .nav-links .dropdown:hover .dropdown-content {
            display: block;
        }

        .nav-links .dropdown-content li {
            list-style: none;
        }

        .nav-links .dropdown-content a {
            padding: 10px 20px;
            border-radius: 0;
        }

        .nav-links .dropdown-content .nested {
            padding-left: 0;
        }

        .nav-links .dropdown-content .nested > strong {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
        }

        .nav-links .dropdown-content .nested > strong:hover {
            background: rgba(0, 255, 65, 0.1);
        }

        .nav-links .dropdown-content .nested > strong::after {
            content: '‚ñº';
            font-size: 0.8em;
            transition: transform 0.3s ease;
            color: var(--text-primary);
        }

        .nav-links .dropdown-content .nested.collapsed > strong::after {
            transform: rotate(-90deg);
        }

        .nav-links .dropdown-content .nested .unit-lessons {
            max-height: 500px;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .nav-links .dropdown-content .nested.collapsed .unit-lessons {
            max-height: 0;
        }

        .nav-links .dropdown-content .nested .unit-lessons li {
            padding-left: 20px;
        }

        .nav-links .dropdown-content .nested a {
            padding: 8px 20px;
            font-size: 0.9em;
            color: var(--text-muted);
        }

        .nav-links .dropdown-content .nested a:hover {
            color: var(--text-primary);
            background: rgba(0, 255, 65, 0.05);
        }

        /* Mobile menu toggle */
        .nav-toggle {
            display: none;
            background: none;
            border: 2px solid var(--text-primary);
            color: var(--text-primary);
            padding: 8px 15px;
            cursor: pointer;
            border-radius: 4px;
        }

        /* Search */
        .search-container {
            position: relative;
            margin-left: 20px;
        }

        .search-input {
            padding: 8px 35px 8px 15px;
            background: var(--bg-primary);
            border: 2px solid var(--border);
            border-radius: 6px;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            width: 250px;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--text-primary);
            box-shadow: 0 0 15px rgba(0, 255, 65, 0.2);
        }

        .search-input::placeholder {
            color: var(--text-muted);
        }

        .search-icon {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
            pointer-events: none;
        }

        .search-results {
            position: absolute;
            top: calc(100% + 10px);
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            border: 2px solid var(--text-primary);
            border-radius: 8px;
            max-height: 400px;
            overflow-y: auto;
            display: none;
            z-index: 2000;
            box-shadow: 0 8px 30px rgba(0, 255, 65, 0.3);
        }

        .search-results.active {
            display: block;
        }

        .search-result-item {
            padding: 15px;
            border-bottom: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .search-result-item:last-child {
            border-bottom: none;
        }

        .search-result-item:hover {
            background: rgba(0, 255, 65, 0.05);
        }

        .search-result-title {
            color: var(--text-primary);
            font-weight: 700;
            margin-bottom: 5px;
        }

        .search-result-path {
            color: var(--text-muted);
            font-size: 0.8rem;
            margin-bottom: 8px;
        }

        .search-result-excerpt {
            color: var(--text-secondary);
            font-size: 0.85rem;
            line-height: 1.4;
        }

        .search-highlight {
            background: var(--text-primary);
            color: var(--bg-primary);
            padding: 2px 4px;
            border-radius: 2px;
            font-weight: 700;
        }

        .search-no-results {
            padding: 20px;
            text-align: center;
            color: var(--text-muted);
        }

        .search-results::-webkit-scrollbar {
            width: 8px;
        }

        .search-results::-webkit-scrollbar-track {
            background: var(--bg-primary);
        }

        .search-results::-webkit-scrollbar-thumb {
            background: var(--text-primary);
            border-radius: 4px;
        }

        /* Main Content */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 30px;
        }

        /* Typography */
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Orbitron', sans-serif;
            color: var(--text-primary);
            margin-top: 2rem;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        h1 {
            font-size: 2.5rem;
            text-shadow: 0 0 20px var(--text-primary);
            letter-spacing: 0.05em;
            border-bottom: 2px solid var(--text-primary);
            padding-bottom: 15px;
        }

        h2 {
            font-size: 2rem;
            border-left: 4px solid var(--text-primary);
            padding-left: 15px;
        }

        h3 { font-size: 1.5rem; }
        h4 { font-size: 1.25rem; }

        p {
            margin-bottom: 1.2rem;
            color: var(--text-secondary);
        }

        a {
            color: var(--accent-secondary);
            text-decoration: none;
            transition: all 0.3s ease;
        }

        a:hover {
            color: var(--text-primary);
            text-shadow: 0 0 10px var(--text-primary);
        }

        /* Code Blocks */
        code {
            background: var(--bg-secondary);
            color: var(--text-primary);
            padding: 2px 8px;
            border-radius: 4px;
            border: 1px solid var(--border);
            font-family: 'JetBrains Mono', monospace;
        }

        pre {
            background: var(--bg-secondary);
            border: 2px solid var(--text-primary);
            border-radius: 8px;
            padding: 20px;
            overflow-x: auto;
            margin: 20px 0;
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.2);
        }

        pre code {
            background: transparent;
            border: none;
            padding: 0;
        }

        /* Lists */
        ul, ol {
            margin-left: 30px;
            margin-bottom: 1.2rem;
        }

        li {
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
        }

        li::marker {
            color: var(--text-primary);
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
        }

        th {
            background: var(--bg-primary);
            color: var(--text-primary);
            padding: 12px;
            text-align: left;
            border: 1px solid var(--text-primary);
            font-weight: 700;
        }

        td {
            padding: 12px;
            border: 1px solid var(--border);
        }

        tr:hover {
            background: rgba(0, 255, 65, 0.05);
        }

        /* Blockquotes */
        blockquote {
            border-left: 4px solid var(--text-primary);
            background: var(--bg-secondary);
            padding: 15px 20px;
            margin: 20px 0;
            font-style: italic;
        }

        /* Images */
        img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 20px 0;
        }

        /* Horizontal Rule */
        hr {
            border: none;
            border-top: 2px solid var(--text-primary);
            margin: 30px 0;
            opacity: 0.3;
        }

        /* Footer */
        footer {
            background: var(--bg-secondary);
            border-top: 2px solid var(--text-primary);
            padding: 30px;
            margin-top: 60px;
            text-align: center;
            color: var(--text-muted);
        }

        /* Scanline Effect */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                to bottom,
                transparent 50%,
                rgba(0, 255, 65, 0.02) 51%
            );
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 9999;
            animation: scan 8s linear infinite;
        }

        @keyframes scan {
            0% { transform: translateY(0); }
            100% { transform: translateY(100%); }
        }

        /* Selection */
        ::selection {
            background: var(--text-primary);
            color: var(--bg-primary);
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 12px;
            background: var(--bg-primary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--text-primary);
            border-radius: 6px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-secondary);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .nav-toggle {
                display: block;
            }

            .nav-links {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: var(--bg-secondary);
                flex-direction: column;
                padding: 20px;
                border-bottom: 2px solid var(--text-primary);
            }

            .nav-links.active {
                display: flex;
            }

            h1 {
                font-size: 2rem;
            }

            .container {
                padding: 20px 15px;
            }

            .search-container {
                margin-left: 10px;
            }

            .search-input {
                width: 200px;
            }
        }

        /* Search Box */
        .search-box {
            padding: 10px;
            background: var(--bg-primary);
            border: 1px solid var(--text-primary);
            border-radius: 4px;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
        }

        .search-box::placeholder {
            color: var(--text-muted);
        }

        /* Lesson Navigation */
        .lesson-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 60px 0 40px 0;
            padding: 30px;
            background: var(--bg-secondary);
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .lesson-nav-button {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px 30px;
            background: var(--bg-primary);
            border: 2px solid var(--text-primary);
            border-radius: 8px;
            color: var(--text-primary);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            font-family: 'JetBrains Mono', monospace;
        }

        .lesson-nav-button:hover {
            background: var(--text-primary);
            color: var(--bg-primary);
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 255, 65, 0.3);
        }

        .lesson-nav-button.disabled {
            opacity: 0.3;
            pointer-events: none;
        }

        .lesson-nav-button .arrow {
            font-size: 1.2rem;
            font-weight: bold;
        }

        .lesson-nav-info {
            text-align: center;
            color: var(--text-secondary);
        }

        .lesson-nav-info .current-lesson {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-bottom: 5px;
        }

        .lesson-nav-info .lesson-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        @media (max-width: 768px) {
            .lesson-nav {
                flex-direction: column;
                gap: 20px;
            }

            .lesson-nav-button {
                width: 100%;
                justify-content: center;
            }

            .lesson-nav-info {
                order: -1;
            }
        }
    </style>
</head>
<body>
    <nav>
        <div class="nav-container">
            <div class="nav-logo">
                
                <img src="../../../img/logo.png" alt="Logo">
                
                <a href="https://mohamed-morsy33.github.io/cybersecuritynchs/">NCHS Cybersecurity</a>
            </div>
            
            <button class="nav-toggle" onclick="toggleMenu()">MENU</button>
            
            <ul class="nav-links" id="navLinks">
                
                <li >
                    
                        <a href="../../.." 
                           >
                            Home
                        </a>
                    
                </li>
                
                <li class="dropdown">
                    
                        <a href="#">Curriculum</a>
                        <ul class="dropdown-content">
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 1</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit1/lesson1-1/">Lesson 1.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit1/lesson1-2/">Lesson 1.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit1/lesson1-3/">Lesson 1.3</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit1/lesson1-4/">Lesson 1.4</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit1/lesson1-5/">Lesson 1.5</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit1/lesson1-6/">Lesson 1.6</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit1/installation-process/">Linux Installation Process</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 2</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit2/lesson2-1/">Lesson 2.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit2/lesson2-2/">Lesson 2.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit2/lesson2-3/">Lesson 2.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 3</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit3/lesson3-1/">Lesson 3.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit3/lesson3-2/">Lesson 3.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit3/lesson3-3/">Lesson 3.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 4</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit4/lesson4-1/">Lesson 4.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit4/lesson4-2/">Lesson 4.2</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 5</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit5/lesson5-1/">Lesson 5.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit5/lesson5-2/">Lesson 5.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit5/lesson5-3/">Lesson 5.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 6</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit6/lesson6-1/">Lesson 6.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit6/lesson6-2/">Lesson 6.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit6/lesson6-3/">Lesson 6.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 7</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit7/lesson7-1/">Lesson 7.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit7/lesson7-2/">Lesson 7.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit7/lesson7-3/">Lesson 7.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 8</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit8/lesson8-1/">Lesson 8.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit8/lesson8-2/">Lesson 8.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit8/lesson8-3/">Lesson 8.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 9</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit9/lesson9-1/">Lesson 9.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit9/lesson9-2/">Lesson 9.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit9/lesson9-3/">Lesson 9.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 10</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../lesson10-1/">Lesson 10.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="./">Lesson 10.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../lesson10-3/">Lesson 10.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 11</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit11/lesson11-1/">Lesson 11.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit11/lesson11-2/">Lesson 11.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit11/lesson11-3/">Lesson 11.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                        </ul>
                    
                </li>
                
                <li >
                    
                        <a href="../../../test/" 
                           >
                            Terminal
                        </a>
                    
                </li>
                
            </ul>

            <div class="search-container">
                <input type="text" 
                       class="search-input" 
                       id="searchInput" 
                       placeholder="Search lessons..."
                       autocomplete="off">
                <span class="search-icon">üîç</span>
                <div class="search-results" id="searchResults"></div>
            </div>
        </div>
    </nav>

    <div class="container">
        
        <h1 id="incident-response-and-digital-forensics">Incident Response and Digital Forensics</h1>
<p>When prevention fails, incident response saves the day. This lesson covers how to detect, respond to, and recover from security incidents while preserving evidence for investigation and potential legal proceedings.</p>
<h2 id="incident-response-framework">Incident Response Framework</h2>
<h3 id="nist-incident-response-lifecycle">NIST Incident Response Lifecycle</h3>
<p><strong>4 phases:</strong></p>
<ol>
<li><strong>Preparation</strong> - Build capability before incident occurs</li>
<li><strong>Detection &amp; Analysis</strong> - Identify and understand incident</li>
<li><strong>Containment, Eradication &amp; Recovery</strong> - Stop damage and restore</li>
<li><strong>Post-Incident Activity</strong> - Learn and improve</li>
</ol>
<h3 id="sans-incident-response-process">SANS Incident Response Process</h3>
<p><strong>6 steps:</strong></p>
<ol>
<li><strong>Preparation</strong> - Tools, training, policies</li>
<li><strong>Identification</strong> - Detect and verify incident</li>
<li><strong>Containment</strong> - Limit damage</li>
<li><strong>Eradication</strong> - Remove threat</li>
<li><strong>Recovery</strong> - Restore systems</li>
<li><strong>Lessons Learned</strong> - Document and improve</li>
</ol>
<h2 id="preparation-phase">Preparation Phase</h2>
<h3 id="building-an-incident-response-team">Building an Incident Response Team</h3>
<p><strong>Core roles:</strong></p>
<p><strong>Incident Response Manager</strong>
- Coordinates response
- Makes critical decisions
- Communicates with stakeholders
- Manages resources</p>
<p><strong>Security Analyst</strong>
- Analyzes alerts and logs
- Identifies indicators of compromise
- Performs triage
- Documents findings</p>
<p><strong>Forensic Investigator</strong>
- Preserves evidence
- Analyzes systems
- Reconstructs events
- Prepares reports</p>
<p><strong>System Administrator</strong>
- Provides technical access
- Implements containment
- Restores systems
- Maintains business operations</p>
<p><strong>Legal Counsel</strong>
- Advises on legal obligations
- Manages law enforcement interaction
- Protects attorney-client privilege
- Handles disclosure requirements</p>
<p><strong>Communications Lead</strong>
- Internal communications
- External communications
- Media relations
- Customer notifications</p>
<h3 id="essential-tools">Essential Tools</h3>
<p><strong>Network monitoring:</strong>
- Wireshark / tcpdump
- Zeek (Bro)
- Security Onion
- Suricata / Snort</p>
<p><strong>Endpoint detection:</strong>
- OSSEC / Wazuh
- Sysmon
- osquery
- Velociraptor</p>
<p><strong>Memory analysis:</strong>
- Volatility
- Rekall
- WinDbg</p>
<p><strong>Disk forensics:</strong>
- Autopsy / Sleuth Kit
- FTK Imager
- EnCase
- X-Ways Forensics</p>
<p><strong>Log analysis:</strong>
- ELK Stack (Elasticsearch, Logstash, Kibana)
- Splunk
- Graylog</p>
<p><strong>Malware analysis:</strong>
- Cuckoo Sandbox
- REMnux
- FLARE VM
- IDA Pro / Ghidra</p>
<h3 id="incident-response-plan">Incident Response Plan</h3>
<p><strong>Key components:</strong></p>
<pre><code>1. Contact Information
   - Team members (phone, email, backup)
   - Vendors (IT, security, legal)
   - Law enforcement
   - Insurance

2. Roles and Responsibilities
   - Who does what
   - Decision authority
   - Escalation paths

3. Communication Plan
   - Internal notifications
   - External notifications
   - Media statements
   - Customer communications

4. Detection and Analysis
   - Alert sources
   - Triage procedures
   - Severity classification
   - Documentation requirements

5. Containment Strategies
   - Network isolation procedures
   - Account disabling
   - System shutdown criteria

6. Evidence Collection
   - Chain of custody forms
   - Collection procedures
   - Storage requirements

7. Eradication and Recovery
   - Malware removal
   - System rebuild
   - Verification procedures

8. Post-Incident
   - Lessons learned template
   - Improvement tracking
</code></pre>
<h2 id="detection-analysis">Detection &amp; Analysis</h2>
<h3 id="indicators-of-compromise-iocs">Indicators of Compromise (IOCs)</h3>
<p><strong>Network IOCs:</strong>
- Suspicious IP addresses
- Unusual DNS queries
- C2 beacon patterns
- Large data transfers
- Connections to known bad domains</p>
<p><strong>Host IOCs:</strong>
- Unexpected processes
- New user accounts
- Modified system files
- Suspicious registry keys
- Scheduled tasks
- Unknown services</p>
<p><strong>Application IOCs:</strong>
- Failed login attempts
- Privilege escalation
- Unusual access patterns
- Error messages
- Configuration changes</p>
<h3 id="alert-triage">Alert Triage</h3>
<p><strong>Priority classification:</strong></p>
<p><strong>Critical (P1):</strong>
- Active data exfiltration
- Ransomware execution
- System compromise with admin access
- Critical infrastructure impact
- Response time: Immediate</p>
<p><strong>High (P2):</strong>
- Malware detected
- Privilege escalation attempt
- Credential compromise
- Response time: &lt; 1 hour</p>
<p><strong>Medium (P3):</strong>
- Policy violation
- Suspicious activity
- Reconnaissance detected
- Response time: &lt; 4 hours</p>
<p><strong>Low (P4):</strong>
- Failed attack attempt
- Scanner activity
- False positive likely
- Response time: &lt; 24 hours</p>
<h3 id="initial-analysis">Initial Analysis</h3>
<p><strong>Questions to answer:</strong></p>
<ol>
<li><strong>What happened?</strong></li>
<li>Type of incident</li>
<li>Attack vector</li>
<li>
<p>Malware involved</p>
</li>
<li>
<p><strong>When did it start?</strong></p>
</li>
<li>First compromise</li>
<li>Detection time</li>
<li>
<p>Dwell time</p>
</li>
<li>
<p><strong>What systems affected?</strong></p>
</li>
<li>Compromised hosts</li>
<li>Accessed data</li>
<li>
<p>Network segments</p>
</li>
<li>
<p><strong>Who is the attacker?</strong></p>
</li>
<li>Internal/external</li>
<li>Sophistication level</li>
<li>
<p>Possible attribution</p>
</li>
<li>
<p><strong>What's the impact?</strong></p>
</li>
<li>Data loss</li>
<li>System availability</li>
<li>Business impact</li>
</ol>
<h2 id="containment">Containment</h2>
<h3 id="short-term-containment">Short-term Containment</h3>
<p><strong>Immediate actions to limit damage:</strong></p>
<p><strong>Network isolation:</strong></p>
<pre><code class="language-bash"># Isolate host using firewall
iptables -I INPUT 1 -s &lt;attacker_ip&gt; -j DROP
iptables -I OUTPUT 1 -d &lt;attacker_ip&gt; -j DROP

# Or disconnect network entirely
ifconfig eth0 down

# On Windows
netsh interface set interface &quot;Ethernet&quot; admin=disable
</code></pre>
<p><strong>Account suspension:</strong></p>
<pre><code class="language-bash"># Disable compromised user (Linux)
passwd -l username
usermod -L username

# Disable AD account (Windows)
Disable-ADAccount -Identity username

# Force password reset
Set-ADAccountPassword -Identity username -Reset
</code></pre>
<p><strong>Block malicious IPs:</strong></p>
<pre><code class="language-bash"># Firewall rules
ufw deny from &lt;malicious_ip&gt;

# At network level (contact network team)
# Block at firewall/IDS
</code></pre>
<h3 id="long-term-containment">Long-term Containment</h3>
<p><strong>Allows business to continue while preparing for eradication:</strong></p>
<p><strong>Segment network:</strong>
- Move affected systems to isolated VLAN
- Restrict traffic flow
- Monitor for lateral movement</p>
<p><strong>Apply patches:</strong>
- Patch exploited vulnerabilities
- Update signatures
- Harden configurations</p>
<p><strong>Strengthen authentication:</strong>
- Force password resets
- Implement MFA
- Review permissions</p>
<h2 id="evidence-collection">Evidence Collection</h2>
<h3 id="order-of-volatility">Order of Volatility</h3>
<p><strong>Collect most volatile data first:</strong></p>
<ol>
<li><strong>Registers, cache</strong> - Nanoseconds</li>
<li><strong>Memory (RAM)</strong> - Seconds to minutes</li>
<li><strong>Network connections</strong> - Seconds</li>
<li><strong>Running processes</strong> - Seconds</li>
<li><strong>Open files</strong> - Minutes</li>
<li><strong>Network configuration</strong> - Minutes</li>
<li><strong>Disk contents</strong> - Hours to days</li>
<li><strong>Logs</strong> - Days to months</li>
<li><strong>Backups</strong> - Months to years</li>
</ol>
<h3 id="memory-acquisition">Memory Acquisition</h3>
<p><strong>Linux:</strong></p>
<pre><code class="language-bash"># Using LiME (Linux Memory Extractor)
sudo insmod lime.ko &quot;path=/tmp/memory.dump format=lime&quot;

# Or dump with dd (less reliable)
sudo dd if=/dev/mem of=/tmp/memory.dump bs=1M
</code></pre>
<p><strong>Windows:</strong></p>
<pre><code class="language-powershell"># Using WinPMEM
winpmem.exe memory.dump

# Using DumpIt
DumpIt.exe

# Using FTK Imager
# GUI tool - select Capture Memory
</code></pre>
<p><strong>Memory analysis:</strong></p>
<pre><code class="language-bash"># Volatility framework
volatility -f memory.dump imageinfo

# List processes
volatility -f memory.dump --profile=Win10x64 pslist

# Network connections
volatility -f memory.dump --profile=Win10x64 netscan

# List DLLs
volatility -f memory.dump --profile=Win10x64 dlllist

# Dump process
volatility -f memory.dump --profile=Win10x64 procdump -p 1234 -D output/

# Scan for malware
volatility -f memory.dump --profile=Win10x64 malfind
</code></pre>
<h3 id="disk-acquisition">Disk Acquisition</h3>
<p><strong>Create forensic image:</strong></p>
<pre><code class="language-bash"># Using dd (forensic copy)
sudo dd if=/dev/sda of=/mnt/evidence/disk.img bs=4M status=progress conv=noerror,sync

# Calculate hash
sha256sum /mnt/evidence/disk.img &gt; /mnt/evidence/disk.img.sha256

# Using dcfldd (better for forensics)
sudo dcfldd if=/dev/sda of=/mnt/evidence/disk.img hash=sha256 hashlog=/mnt/evidence/hash.log

# Using FTK Imager (Windows GUI)
# File ‚Üí Create Disk Image ‚Üí Select source ‚Üí Create image
</code></pre>
<p><strong>Mount as read-only:</strong></p>
<pre><code class="language-bash"># Mount forensic image
sudo mount -o ro,loop disk.img /mnt/evidence

# Or use write blocker hardware
</code></pre>
<h3 id="network-evidence">Network Evidence</h3>
<p><strong>Capture live traffic:</strong></p>
<pre><code class="language-bash"># Full packet capture
sudo tcpdump -i eth0 -w incident.pcap

# Capture specific host
sudo tcpdump -i eth0 host 192.168.1.100 -w suspect.pcap

# Capture for specific time
timeout 3600 sudo tcpdump -i eth0 -w hourly.pcap
</code></pre>
<p><strong>Export NetFlow data:</strong></p>
<pre><code class="language-bash"># Export flows from router/switch
# Query flow collector for incident timeframe
nfdump -R /data/flows -t 2024-01-15.14:00-2024-01-15.16:00 -o extended
</code></pre>
<h3 id="log-collection">Log Collection</h3>
<p><strong>Centralized logging:</strong></p>
<pre><code class="language-bash"># Linux system logs
sudo cp -r /var/log /mnt/evidence/logs/

# Windows Event logs
wevtutil epl System C:\evidence\System.evtx
wevtutil epl Security C:\evidence\Security.evtx
wevtutil epl Application C:\evidence\Application.evtx

# Web server logs
sudo cp /var/log/apache2/access.log /mnt/evidence/
sudo cp /var/log/apache2/error.log /mnt/evidence/
</code></pre>
<p><strong>Timeline creation:</strong></p>
<pre><code class="language-bash"># Create timeline with log2timeline/plaso
log2timeline.py timeline.plaso /mnt/evidence/

# Generate timeline
psort.py -o l2tcsv -w timeline.csv timeline.plaso

# Filter timeline
psort.py -o l2tcsv timeline.plaso &quot;date &gt; '2024-01-15 14:00:00'&quot;
</code></pre>
<h3 id="chain-of-custody">Chain of Custody</h3>
<p><strong>Documentation required:</strong></p>
<pre><code>Evidence Form

Case Number: IR-2024-001
Evidence Number: E-001
Date/Time Collected: 2024-01-15 14:23:15 UTC
Collected By: John Smith, Incident Responder
Location: Server Room, Building A, Floor 3
Description: Hard drive from compromised web server
Make/Model: Seagate ST2000DM008 2TB
Serial Number: ZDH12345
Hash (SHA-256): abc123def456...

Chain of Custody:
Date/Time | Transferred From | Transferred To | Purpose | Signature
----------------------------------------------------------------------
2024-01-15 14:23 | John Smith | Evidence locker | Storage | J. Smith
2024-01-15 16:45 | Evidence locker | Jane Doe | Analysis | J. Doe
2024-01-16 10:00 | Jane Doe | Evidence locker | Storage | J. Doe
</code></pre>
<h2 id="analysis">Analysis</h2>
<h3 id="timeline-reconstruction">Timeline Reconstruction</h3>
<p><strong>Build event timeline:</strong></p>
<pre><code>2024-01-15 13:45:22 - Phishing email received by user@company.com
2024-01-15 13:47:15 - User clicks malicious link
2024-01-15 13:47:23 - Malware downloaded (invoice.pdf.exe)
2024-01-15 13:48:01 - Malware executed
2024-01-15 13:48:15 - First C2 beacon to evil.com
2024-01-15 14:15:33 - Credential dumping (mimikatz)
2024-01-15 14:45:22 - Lateral movement to file server
2024-01-15 15:23:11 - Large file transfer begins (data exfiltration)
2024-01-15 16:30:44 - Ransomware deployment
2024-01-15 16:31:00 - Files encrypted
2024-01-15 16:35:12 - Ransom note displayed
</code></pre>
<h3 id="root-cause-analysis">Root Cause Analysis</h3>
<p><strong>5 Whys technique:</strong></p>
<pre><code>Problem: Ransomware encrypted critical files

Why? Ransomware was executed on the network
  Why? Attacker had access to deploy ransomware
    Why? Attacker moved laterally from initial compromise
      Why? User credentials were compromised
        Why? User clicked phishing link and ran malware
          Root cause: Insufficient user security awareness training
                     No email filtering for malicious links
</code></pre>
<h3 id="indicators-of-compromise-extraction">Indicators of Compromise Extraction</h3>
<p><strong>Create IOC list:</strong></p>
<pre><code class="language-python">#!/usr/bin/env python3
# extract_iocs.py

import re
import sys

def extract_iocs(logfile):
    &quot;&quot;&quot;Extract IOCs from logs&quot;&quot;&quot;
    iocs = {
        'ips': set(),
        'domains': set(),
        'urls': set(),
        'hashes': set(),
        'emails': set()
    }

    # Regex patterns
    ip_pattern = r'\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b'
    domain_pattern = r'\b(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]\b'
    url_pattern = r'https?://[^\s&lt;&gt;&quot;{}|\\^`\[\]]+' 
    hash_pattern = r'\b[a-f0-9]{32}\b|\b[a-f0-9]{40}\b|\b[a-f0-9]{64}\b'
    email_pattern = r'\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b'

    with open(logfile, 'r', errors='ignore') as f:
        content = f.read()

        iocs['ips'].update(re.findall(ip_pattern, content))
        iocs['domains'].update(re.findall(domain_pattern, content))
        iocs['urls'].update(re.findall(url_pattern, content))
        iocs['hashes'].update(re.findall(hash_pattern, content))
        iocs['emails'].update(re.findall(email_pattern, content))

    # Remove private/internal IPs
    iocs['ips'] = {ip for ip in iocs['ips'] 
                   if not ip.startswith(('10.', '192.168.', '172.'))}

    return iocs

# Usage
if __name__ == '__main__':
    iocs = extract_iocs(sys.argv[1])

    print(&quot;=== Indicators of Compromise ===\n&quot;)
    print(f&quot;IPs ({len(iocs['ips'])}):&quot;)
    for ip in sorted(iocs['ips']):
        print(f&quot;  {ip}&quot;)

    print(f&quot;\nDomains ({len(iocs['domains'])}):&quot;)
    for domain in sorted(iocs['domains']):
        print(f&quot;  {domain}&quot;)

    print(f&quot;\nFile Hashes ({len(iocs['hashes'])}):&quot;)
    for hash_val in sorted(iocs['hashes']):
        print(f&quot;  {hash_val}&quot;)
</code></pre>
<h2 id="eradication-recovery">Eradication &amp; Recovery</h2>
<h3 id="malware-removal">Malware Removal</h3>
<p><strong>Clean infected systems:</strong></p>
<pre><code class="language-bash"># Identify malware
ps aux | grep suspicious_process
netstat -tulpn | grep suspicious_connection

# Kill malicious processes
sudo kill -9 &lt;pid&gt;

# Remove malicious files
sudo rm -f /tmp/malware.exe
sudo rm -f /var/tmp/.hidden_backdoor

# Remove persistence
sudo crontab -e  # Remove malicious cron jobs
sudo systemctl disable malicious.service
sudo rm /etc/systemd/system/malicious.service

# Check and remove from startup
sudo nano /etc/rc.local
</code></pre>
<p><strong>Or rebuild from scratch:</strong>
- Faster and more reliable
- Ensures complete eradication
- Restore from clean backup
- Apply all patches before reconnecting</p>
<h3 id="system-hardening">System Hardening</h3>
<p><strong>Before bringing systems back online:</strong></p>
<pre><code class="language-bash"># Update all software
sudo apt update &amp;&amp; sudo apt upgrade -y

# Remove unnecessary services
sudo systemctl disable &lt;unused_service&gt;

# Configure firewall
sudo ufw enable
sudo ufw default deny incoming
sudo ufw default allow outgoing
sudo ufw allow ssh

# Harden SSH
sudo nano /etc/ssh/sshd_config
# PermitRootLogin no
# PasswordAuthentication no
# AllowUsers specific_user

# Enable logging
sudo systemctl enable rsyslog
sudo systemctl enable auditd
</code></pre>
<h3 id="verification">Verification</h3>
<p><strong>Confirm eradication:</strong></p>
<pre><code class="language-bash"># Scan for malware
sudo clamscan -r /
sudo rkhunter --check

# Check for suspicious processes
ps aux | grep -E 'malware|suspicious'

# Check network connections
sudo netstat -tulpn | grep ESTABLISHED

# Review startup items
systemctl list-unit-files | grep enabled

# Check for new users
cat /etc/passwd | tail -10

# Monitor for 72 hours before declaring success
</code></pre>
<h2 id="post-incident-activities">Post-Incident Activities</h2>
<h3 id="lessons-learned-meeting">Lessons Learned Meeting</h3>
<p><strong>Within 2 weeks of incident closure</strong></p>
<p><strong>Agenda:</strong>
1. What happened? (timeline)
2. What went well?
3. What could be improved?
4. What will we do differently?
5. Action items with owners and dates</p>
<p><strong>Questions to answer:</strong></p>
<ul>
<li>How was the incident detected?</li>
<li>Was detection timely?</li>
<li>Were procedures followed?</li>
<li>Were roles and responsibilities clear?</li>
<li>Were tools adequate?</li>
<li>Was communication effective?</li>
<li>What's the estimated cost/impact?</li>
<li>How can we prevent recurrence?</li>
</ul>
<h3 id="incident-report">Incident Report</h3>
<p><strong>Executive summary:</strong>
- What happened (non-technical)
- Impact on business
- Actions taken
- Current status
- Next steps</p>
<p><strong>Technical details:</strong>
- Attack vector
- Timeline of events
- Systems affected
- Indicators of compromise
- Evidence collected
- Analysis findings</p>
<p><strong>Response effectiveness:</strong>
- What worked well
- What needs improvement
- Resources used
- Costs incurred</p>
<p><strong>Recommendations:</strong>
- Immediate actions
- Short-term improvements (30 days)
- Long-term improvements (90+ days)
- Budget requirements</p>
<h2 id="key-takeaways">Key Takeaways</h2>
<p><strong>Incident response success requires:</strong>
- Preparation before incidents occur
- Clear roles and responsibilities
- Well-practiced procedures
- Proper tools and training
- Effective communication
- Thorough documentation</p>
<p><strong>Evidence handling:</strong>
- Maintain chain of custody
- Preserve original evidence
- Work on copies
- Document everything
- Hash all evidence</p>
<p><strong>Critical skills:</strong>
- Quick decision-making under pressure
- Technical analysis capability
- Clear communication
- Attention to detail
- Staying calm</p>
<p><strong>Remember:</strong>
- Every incident is a learning opportunity
- Speed matters but accuracy matters more
- Documentation is crucial
- Team coordination is essential
- Practice makes perfect</p>
<p>Incident response is high-pressure work that requires both technical skill and cool judgment. Regular training, tabletop exercises, and continuous improvement will prepare you to handle real incidents effectively.</p>
        

        <!-- Lesson Navigation (only show on non-homepage pages) -->
        
        <div class="lesson-nav">
            
            <a href="../lesson10-1/" class="lesson-nav-button">
                <span class="arrow">‚Üê</span>
                <span>Previous: Lesson 10.1</span>
            </a>
            

            <div class="lesson-nav-info">
                <div class="current-lesson">Current Lesson</div>
                <div class="lesson-title">Lesson 10.2</div>
            </div>

            
            <a href="../lesson10-3/" class="lesson-nav-button">
                <span>Next: Lesson 10.3</span>
                <span class="arrow">‚Üí</span>
            </a>
            
        </div>
        
    </div>

    <footer>
        <p>NCHS Cybersecurity | Built with MkDocs</p>
        
        <p>Copyright &copy; 2025 Mohamed Morsy</p>
        
    </footer>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm@5.3.0/css/xterm.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/xterm@5.3.0/lib/xterm.min.js"></script>
    
    <script src="../../../search_index.js"></script>
    
    <script>
        function toggleMenu() {
            const navLinks = document.getElementById('navLinks');
            navLinks.classList.toggle('active');
        }

        document.addEventListener('DOMContentLoaded', function() {
            const unitHeaders = document.querySelectorAll('.nav-links .nested > strong');
            
            unitHeaders.forEach(header => {
                header.addEventListener('click', function(e) {
                    e.stopPropagation(); 
                    const parent = this.parentElement;
                    parent.classList.toggle('collapsed');
                });
            });
        });

        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('searchInput');
            const searchResults = document.getElementById('searchResults');
            
            if (!searchInput || !searchResults) {
                return;
            }
            
            let searchIndex = null;
            let useSimpleSearch = false;
            
            const simpleIndex = [
                
                    
                
                    
                        
                            
                                
                                {
                                    title: "Lesson 1.1",
                                    url: '../../unit1/lesson1-1/',
                                    path: 'Curriculum > Unit 1'
                                },
                                
                                {
                                    title: "Lesson 1.2",
                                    url: '../../unit1/lesson1-2/',
                                    path: 'Curriculum > Unit 1'
                                },
                                
                                {
                                    title: "Lesson 1.3",
                                    url: '../../unit1/lesson1-3/',
                                    path: 'Curriculum > Unit 1'
                                },
                                
                                {
                                    title: "Lesson 1.4",
                                    url: '../../unit1/lesson1-4/',
                                    path: 'Curriculum > Unit 1'
                                },
                                
                                {
                                    title: "Lesson 1.5",
                                    url: '../../unit1/lesson1-5/',
                                    path: 'Curriculum > Unit 1'
                                },
                                
                                {
                                    title: "Lesson 1.6",
                                    url: '../../unit1/lesson1-6/',
                                    path: 'Curriculum > Unit 1'
                                },
                                
                                {
                                    title: "Linux Installation Process",
                                    url: '../../unit1/installation-process/',
                                    path: 'Curriculum > Unit 1'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 2.1",
                                    url: '../../unit2/lesson2-1/',
                                    path: 'Curriculum > Unit 2'
                                },
                                
                                {
                                    title: "Lesson 2.2",
                                    url: '../../unit2/lesson2-2/',
                                    path: 'Curriculum > Unit 2'
                                },
                                
                                {
                                    title: "Lesson 2.3",
                                    url: '../../unit2/lesson2-3/',
                                    path: 'Curriculum > Unit 2'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 3.1",
                                    url: '../../unit3/lesson3-1/',
                                    path: 'Curriculum > Unit 3'
                                },
                                
                                {
                                    title: "Lesson 3.2",
                                    url: '../../unit3/lesson3-2/',
                                    path: 'Curriculum > Unit 3'
                                },
                                
                                {
                                    title: "Lesson 3.3",
                                    url: '../../unit3/lesson3-3/',
                                    path: 'Curriculum > Unit 3'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 4.1",
                                    url: '../../unit4/lesson4-1/',
                                    path: 'Curriculum > Unit 4'
                                },
                                
                                {
                                    title: "Lesson 4.2",
                                    url: '../../unit4/lesson4-2/',
                                    path: 'Curriculum > Unit 4'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 5.1",
                                    url: '../../unit5/lesson5-1/',
                                    path: 'Curriculum > Unit 5'
                                },
                                
                                {
                                    title: "Lesson 5.2",
                                    url: '../../unit5/lesson5-2/',
                                    path: 'Curriculum > Unit 5'
                                },
                                
                                {
                                    title: "Lesson 5.3",
                                    url: '../../unit5/lesson5-3/',
                                    path: 'Curriculum > Unit 5'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 6.1",
                                    url: '../../unit6/lesson6-1/',
                                    path: 'Curriculum > Unit 6'
                                },
                                
                                {
                                    title: "Lesson 6.2",
                                    url: '../../unit6/lesson6-2/',
                                    path: 'Curriculum > Unit 6'
                                },
                                
                                {
                                    title: "Lesson 6.3",
                                    url: '../../unit6/lesson6-3/',
                                    path: 'Curriculum > Unit 6'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 7.1",
                                    url: '../../unit7/lesson7-1/',
                                    path: 'Curriculum > Unit 7'
                                },
                                
                                {
                                    title: "Lesson 7.2",
                                    url: '../../unit7/lesson7-2/',
                                    path: 'Curriculum > Unit 7'
                                },
                                
                                {
                                    title: "Lesson 7.3",
                                    url: '../../unit7/lesson7-3/',
                                    path: 'Curriculum > Unit 7'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 8.1",
                                    url: '../../unit8/lesson8-1/',
                                    path: 'Curriculum > Unit 8'
                                },
                                
                                {
                                    title: "Lesson 8.2",
                                    url: '../../unit8/lesson8-2/',
                                    path: 'Curriculum > Unit 8'
                                },
                                
                                {
                                    title: "Lesson 8.3",
                                    url: '../../unit8/lesson8-3/',
                                    path: 'Curriculum > Unit 8'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 9.1",
                                    url: '../../unit9/lesson9-1/',
                                    path: 'Curriculum > Unit 9'
                                },
                                
                                {
                                    title: "Lesson 9.2",
                                    url: '../../unit9/lesson9-2/',
                                    path: 'Curriculum > Unit 9'
                                },
                                
                                {
                                    title: "Lesson 9.3",
                                    url: '../../unit9/lesson9-3/',
                                    path: 'Curriculum > Unit 9'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 10.1",
                                    url: '../lesson10-1/',
                                    path: 'Curriculum > Unit 10'
                                },
                                
                                {
                                    title: "Lesson 10.2",
                                    url: './',
                                    path: 'Curriculum > Unit 10'
                                },
                                
                                {
                                    title: "Lesson 10.3",
                                    url: '../lesson10-3/',
                                    path: 'Curriculum > Unit 10'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 11.1",
                                    url: '../../unit11/lesson11-1/',
                                    path: 'Curriculum > Unit 11'
                                },
                                
                                {
                                    title: "Lesson 11.2",
                                    url: '../../unit11/lesson11-2/',
                                    path: 'Curriculum > Unit 11'
                                },
                                
                                {
                                    title: "Lesson 11.3",
                                    url: '../../unit11/lesson11-3/',
                                    path: 'Curriculum > Unit 11'
                                },
                                
                            
                        
                    
                
                    
                        {
                            title: "Terminal",
                            url: '../../../test/',
                            path: 'Main'
                        },
                    
                
            ];
            
            if (typeof window.searchIndex !== 'undefined') {
                searchIndex = window.searchIndex;
                useSimpleSearch = false;
                console.log('‚úì Using embedded search index:', searchIndex.docs.length, 'documents');
            } else {
                const base_url = document.querySelector('base')?.getAttribute('href') || '/';
                fetch(base_url + 'search_data.js')
                    .then(response => response.text())
                    .then(data => {
                        eval(data);  
                        if (window.searchIndex) {
                            searchIndex = window.searchIndex;
                            useSimpleSearch = false;
                            console.log('‚úì Loaded search index from JS:', searchIndex.docs.length, 'documents');
                        }
                    })
                    .catch(() => {
                        console.log('Using simple title search (full search not available)');
                        useSimpleSearch = true;
                    });
                
                useSimpleSearch = true; 
            }
            
            function performSearch(query) {
                if (!query || query.length < 2) {
                    searchResults.classList.remove('active');
                    return;
                }
                
                if (useSimpleSearch || !searchIndex) {
                    performSimpleSearch(query);
                } else {
                    performFullSearch(query);
                }
            }
            
            function performSimpleSearch(query) {
                const lowerQuery = query.toLowerCase();
                const results = simpleIndex.filter(item => 
                    item.title.toLowerCase().includes(lowerQuery)
                );
                displaySimpleResults(results, query);
            }
            
            function performFullSearch(query) {
                const lowerQuery = query.toLowerCase();
                const queryTerms = lowerQuery.split(/\s+/);
                
                const results = searchIndex.docs
                    .map(doc => {
                        let score = 0;
                        let matchedText = '';
                        
                        if (doc.title && doc.title.toLowerCase().includes(lowerQuery)) {
                            score += 10;
                        }
                        
                        if (doc.text) {
                            const text = doc.text.toLowerCase();
                            queryTerms.forEach(term => {
                                if (term.length < 2) return;
                                const count = (text.match(new RegExp(escapeRegex(term), 'g')) || []).length;
                                score += count;
                                
                                if (count > 0 && !matchedText) {
                                    const index = text.indexOf(term);
                                    const start = Math.max(0, index - 50);
                                    const end = Math.min(text.length, index + term.length + 50);
                                    matchedText = doc.text.substring(start, end);
                                    if (start > 0) matchedText = '...' + matchedText;
                                    if (end < text.length) matchedText = matchedText + '...';
                                }
                            });
                        }
                        
                        return {
                            title: doc.title,
                            location: doc.location,
                            text: matchedText || (doc.text ? doc.text.substring(0, 150) + '...' : ''),
                            score: score
                        };
                    })
                    .filter(result => result.score > 0)
                    .sort((a, b) => b.score - a.score);
                
                displayFullResults(results, query);
            }
            
            function displaySimpleResults(results, query) {
                if (results.length === 0) {
                    searchResults.innerHTML = '<div class="search-no-results">No results found</div>';
                    searchResults.classList.add('active');
                    return;
                }
                
                const html = results.slice(0, 10).map(result => {
                    const highlightedTitle = highlightText(result.title, query);
                    return `
                        <a href="${result.url}" class="search-result-item">
                            <div class="search-result-title">${highlightedTitle}</div>
                            <div class="search-result-path">${escapeHtml(result.path)}</div>
                        </a>
                    `;
                }).join('');
                
                searchResults.innerHTML = html;
                searchResults.classList.add('active');
            }
            
            function displayFullResults(results, query) {
                if (results.length === 0) {
                    searchResults.innerHTML = '<div class="search-no-results">No results found</div>';
                    searchResults.classList.add('active');
                    return;
                }
                
                const pathname = window.location.pathname;
                let basePath = '/';
                
                const pathParts = pathname.split('/').filter(p => p);
                
                if (pathParts.length > 0 && !pathParts[0].endsWith('.html')) {
                    const firstPart = pathParts[0];
                    if (firstPart !== 'index' && firstPart !== 'search') {
                        basePath = '/' + firstPart + '/';
                    }
                }
                
                console.log('Current pathname:', pathname);
                console.log('Detected base path:', basePath);
                
                const html = results.slice(0, 10).map(result => {
                    const highlightedTitle = highlightText(result.title, query);
                    const highlightedText = highlightText(result.text, query);
                    
                    let path = result.location.replace(/^\//, '').replace(/\.html$/, '').replace(/\//g, ' > ');
                    if (!path) path = 'Home';
                    
                    let url;
                    if (basePath === '/') {
                        url = result.location;
                    } else {
                        const cleanLocation = result.location.startsWith('/') ? result.location.substring(1) : result.location;
                        url = basePath + cleanLocation;
                    }
                    
                    console.log('Result:', result.title, '-> URL:', url);
                    
                    return `
                        <a href="${url}" class="search-result-item">
                            <div class="search-result-title">${highlightedTitle}</div>
                            <div class="search-result-path">${escapeHtml(path)}</div>
                            <div class="search-result-excerpt">${highlightedText}</div>
                        </a>
                    `;
                }).join('');
                
                searchResults.innerHTML = html;
                searchResults.classList.add('active');
            }
            
            function highlightText(text, query) {
                if (!text) return '';
                const queryTerms = query.split(/\s+/).filter(t => t.length >= 2);
                let result = escapeHtml(text);
                queryTerms.forEach(term => {
                    const regex = new RegExp('(' + escapeRegex(term) + ')', 'gi');
                    result = result.replace(regex, '<span class="search-highlight">$1</span>');
                });
                return result;
            }
            
            function escapeRegex(string) {
                return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
            }
            
            function escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
            
            let searchTimeout;
            searchInput.addEventListener('input', function(e) {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => performSearch(e.target.value), 300);
            });
            
            searchInput.addEventListener('focus', function(e) {
                if (e.target.value.length >= 2) {
                    performSearch(e.target.value);
                }
            });
            
            document.addEventListener('click', function(e) {
                if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
                    searchResults.classList.remove('active');
                }
            });
            
            searchInput.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    searchResults.classList.remove('active');
                    searchInput.blur();
                }
            });
        });

        
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('pre code').forEach((block) => {
                block.parentElement.style.position = 'relative';
            });
        });
        
    </script>
</body>
</html>