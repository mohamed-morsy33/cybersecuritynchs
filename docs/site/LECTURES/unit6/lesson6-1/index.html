<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 6.1 - NCHS Cybersecurity</title>
    
    
    <link rel="icon" href="../../../img/logo.png">
    
    
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Orbitron:wght@700;900&display=swap" rel="stylesheet">
    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DRPQMPQQS6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-DRPQMPQQS6');
    </script>
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0e27;
            --bg-secondary: #141b3a;
            --text-primary: #00ff41;
            --text-secondary: #7affa7;
            --text-muted: #4a9960;
            --accent: #ff0844;
            --accent-secondary: #00d4ff;
            --border: #1a3a2a;
        }

        body {
            font-family: 'JetBrains Mono', monospace;
            background: var(--bg-primary);
            color: var(--text-secondary);
            line-height: 1.6;
            min-height: 100vh;
        }

        /* Navigation */
        nav {
            background: var(--bg-secondary);
            border-bottom: 2px solid var(--text-primary);
            padding: 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(0, 255, 65, 0.2);
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 30px;
        }

        .nav-logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .nav-logo img {
            height: 40px;
            width: auto;
        }

        .nav-logo a {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            font-weight: 900;
            color: var(--text-primary);
            text-decoration: none;
            letter-spacing: 0.1em;
            text-shadow: 0 0 10px var(--text-primary);
        }

        .nav-links {
            display: flex;
            gap: 30px;
            list-style: none;
            align-items: center;
        }

        .nav-links > li {
            position: relative;
        }

        .nav-links a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            padding: 8px 15px;
            border-radius: 4px;
            display: block;
        }

        .nav-links a:hover,
        .nav-links a.active {
            color: var(--text-primary);
            background: rgba(0, 255, 65, 0.1);
            text-shadow: 0 0 10px var(--text-primary);
        }

        /* Dropdown menu */
        .nav-links .dropdown {
            position: relative;
        }

        .nav-links .dropdown > a::after {
            content: ' ‚ñº';
            font-size: 0.7em;
            margin-left: 5px;
        }

        .nav-links .dropdown-content {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background: var(--bg-secondary);
            border: 2px solid var(--text-primary);
            border-radius: 4px;
            min-width: 250px;
            box-shadow: 0 8px 30px rgba(0, 255, 65, 0.3);
            z-index: 1000;
            padding: 10px 0;
            margin-top: 5px;
        }

        .nav-links .dropdown:hover .dropdown-content {
            display: block;
        }

        .nav-links .dropdown-content li {
            list-style: none;
        }

        .nav-links .dropdown-content a {
            padding: 10px 20px;
            border-radius: 0;
        }

        .nav-links .dropdown-content .nested {
            padding-left: 0;
        }

        .nav-links .dropdown-content .nested > strong {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
        }

        .nav-links .dropdown-content .nested > strong:hover {
            background: rgba(0, 255, 65, 0.1);
        }

        .nav-links .dropdown-content .nested > strong::after {
            content: '‚ñº';
            font-size: 0.8em;
            transition: transform 0.3s ease;
            color: var(--text-primary);
        }

        .nav-links .dropdown-content .nested.collapsed > strong::after {
            transform: rotate(-90deg);
        }

        .nav-links .dropdown-content .nested .unit-lessons {
            max-height: 500px;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .nav-links .dropdown-content .nested.collapsed .unit-lessons {
            max-height: 0;
        }

        .nav-links .dropdown-content .nested .unit-lessons li {
            padding-left: 20px;
        }

        .nav-links .dropdown-content .nested a {
            padding: 8px 20px;
            font-size: 0.9em;
            color: var(--text-muted);
        }

        .nav-links .dropdown-content .nested a:hover {
            color: var(--text-primary);
            background: rgba(0, 255, 65, 0.05);
        }

        /* Mobile menu toggle */
        .nav-toggle {
            display: none;
            background: none;
            border: 2px solid var(--text-primary);
            color: var(--text-primary);
            padding: 8px 15px;
            cursor: pointer;
            border-radius: 4px;
        }

        /* Search */
        .search-container {
            position: relative;
            margin-left: 20px;
        }

        .search-input {
            padding: 8px 35px 8px 15px;
            background: var(--bg-primary);
            border: 2px solid var(--border);
            border-radius: 6px;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            width: 250px;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--text-primary);
            box-shadow: 0 0 15px rgba(0, 255, 65, 0.2);
        }

        .search-input::placeholder {
            color: var(--text-muted);
        }

        .search-icon {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
            pointer-events: none;
        }

        .search-results {
            position: absolute;
            top: calc(100% + 10px);
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            border: 2px solid var(--text-primary);
            border-radius: 8px;
            max-height: 400px;
            overflow-y: auto;
            display: none;
            z-index: 2000;
            box-shadow: 0 8px 30px rgba(0, 255, 65, 0.3);
        }

        .search-results.active {
            display: block;
        }

        .search-result-item {
            padding: 15px;
            border-bottom: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .search-result-item:last-child {
            border-bottom: none;
        }

        .search-result-item:hover {
            background: rgba(0, 255, 65, 0.05);
        }

        .search-result-title {
            color: var(--text-primary);
            font-weight: 700;
            margin-bottom: 5px;
        }

        .search-result-path {
            color: var(--text-muted);
            font-size: 0.8rem;
            margin-bottom: 8px;
        }

        .search-result-excerpt {
            color: var(--text-secondary);
            font-size: 0.85rem;
            line-height: 1.4;
        }

        .search-highlight {
            background: var(--text-primary);
            color: var(--bg-primary);
            padding: 2px 4px;
            border-radius: 2px;
            font-weight: 700;
        }

        .search-no-results {
            padding: 20px;
            text-align: center;
            color: var(--text-muted);
        }

        .search-results::-webkit-scrollbar {
            width: 8px;
        }

        .search-results::-webkit-scrollbar-track {
            background: var(--bg-primary);
        }

        .search-results::-webkit-scrollbar-thumb {
            background: var(--text-primary);
            border-radius: 4px;
        }

        /* Main Content */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 30px;
        }

        /* Typography */
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Orbitron', sans-serif;
            color: var(--text-primary);
            margin-top: 2rem;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        h1 {
            font-size: 2.5rem;
            text-shadow: 0 0 20px var(--text-primary);
            letter-spacing: 0.05em;
            border-bottom: 2px solid var(--text-primary);
            padding-bottom: 15px;
        }

        h2 {
            font-size: 2rem;
            border-left: 4px solid var(--text-primary);
            padding-left: 15px;
        }

        h3 { font-size: 1.5rem; }
        h4 { font-size: 1.25rem; }

        p {
            margin-bottom: 1.2rem;
            color: var(--text-secondary);
        }

        a {
            color: var(--accent-secondary);
            text-decoration: none;
            transition: all 0.3s ease;
        }

        a:hover {
            color: var(--text-primary);
            text-shadow: 0 0 10px var(--text-primary);
        }

        /* Code Blocks */
        code {
            background: var(--bg-secondary);
            color: var(--text-primary);
            padding: 2px 8px;
            border-radius: 4px;
            border: 1px solid var(--border);
            font-family: 'JetBrains Mono', monospace;
        }

        pre {
            background: var(--bg-secondary);
            border: 2px solid var(--text-primary);
            border-radius: 8px;
            padding: 20px;
            overflow-x: auto;
            margin: 20px 0;
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.2);
        }

        pre code {
            background: transparent;
            border: none;
            padding: 0;
        }

        /* Lists */
        ul, ol {
            margin-left: 30px;
            margin-bottom: 1.2rem;
        }

        li {
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
        }

        li::marker {
            color: var(--text-primary);
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
        }

        th {
            background: var(--bg-primary);
            color: var(--text-primary);
            padding: 12px;
            text-align: left;
            border: 1px solid var(--text-primary);
            font-weight: 700;
        }

        td {
            padding: 12px;
            border: 1px solid var(--border);
        }

        tr:hover {
            background: rgba(0, 255, 65, 0.05);
        }

        /* Blockquotes */
        blockquote {
            border-left: 4px solid var(--text-primary);
            background: var(--bg-secondary);
            padding: 15px 20px;
            margin: 20px 0;
            font-style: italic;
        }

        /* Images */
        img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 20px 0;
        }

        /* Horizontal Rule */
        hr {
            border: none;
            border-top: 2px solid var(--text-primary);
            margin: 30px 0;
            opacity: 0.3;
        }

        /* Footer */
        footer {
            background: var(--bg-secondary);
            border-top: 2px solid var(--text-primary);
            padding: 30px;
            margin-top: 60px;
            text-align: center;
            color: var(--text-muted);
        }

        /* Scanline Effect */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                to bottom,
                transparent 50%,
                rgba(0, 255, 65, 0.02) 51%
            );
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 9999;
            animation: scan 8s linear infinite;
        }

        @keyframes scan {
            0% { transform: translateY(0); }
            100% { transform: translateY(100%); }
        }

        /* Selection */
        ::selection {
            background: var(--text-primary);
            color: var(--bg-primary);
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 12px;
            background: var(--bg-primary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--text-primary);
            border-radius: 6px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-secondary);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .nav-toggle {
                display: block;
            }

            .nav-links {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: var(--bg-secondary);
                flex-direction: column;
                padding: 20px;
                border-bottom: 2px solid var(--text-primary);
            }

            .nav-links.active {
                display: flex;
            }

            h1 {
                font-size: 2rem;
            }

            .container {
                padding: 20px 15px;
            }

            .search-container {
                margin-left: 10px;
            }

            .search-input {
                width: 200px;
            }
        }

        /* Search Box */
        .search-box {
            padding: 10px;
            background: var(--bg-primary);
            border: 1px solid var(--text-primary);
            border-radius: 4px;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
        }

        .search-box::placeholder {
            color: var(--text-muted);
        }

        /* Lesson Navigation */
        .lesson-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 60px 0 40px 0;
            padding: 30px;
            background: var(--bg-secondary);
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .lesson-nav-button {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px 30px;
            background: var(--bg-primary);
            border: 2px solid var(--text-primary);
            border-radius: 8px;
            color: var(--text-primary);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            font-family: 'JetBrains Mono', monospace;
        }

        .lesson-nav-button:hover {
            background: var(--text-primary);
            color: var(--bg-primary);
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 255, 65, 0.3);
        }

        .lesson-nav-button.disabled {
            opacity: 0.3;
            pointer-events: none;
        }

        .lesson-nav-button .arrow {
            font-size: 1.2rem;
            font-weight: bold;
        }

        .lesson-nav-info {
            text-align: center;
            color: var(--text-secondary);
        }

        .lesson-nav-info .current-lesson {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-bottom: 5px;
        }

        .lesson-nav-info .lesson-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        @media (max-width: 768px) {
            .lesson-nav {
                flex-direction: column;
                gap: 20px;
            }

            .lesson-nav-button {
                width: 100%;
                justify-content: center;
            }

            .lesson-nav-info {
                order: -1;
            }
        }
    </style>
</head>
<body>
    <nav>
        <div class="nav-container">
            <div class="nav-logo">
                
                <img src="../../../img/logo.png" alt="Logo">
                
                <a href="https://mohamed-morsy33.github.io/cybersecuritynchs/">NCHS Cybersecurity</a>
            </div>
            
            <button class="nav-toggle" onclick="toggleMenu()">MENU</button>
            
            <ul class="nav-links" id="navLinks">
                
                <li >
                    
                        <a href="../../.." 
                           >
                            Home
                        </a>
                    
                </li>
                
                <li class="dropdown">
                    
                        <a href="#">Curriculum</a>
                        <ul class="dropdown-content">
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 1</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit1/lesson1-1/">Lesson 1.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit1/lesson1-2/">Lesson 1.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit1/lesson1-3/">Lesson 1.3</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit1/lesson1-4/">Lesson 1.4</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit1/lesson1-5/">Lesson 1.5</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit1/lesson1-6/">Lesson 1.6</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit1/installation-process/">Linux Installation Process</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 2</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit2/lesson2-1/">Lesson 2.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit2/lesson2-2/">Lesson 2.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit2/lesson2-3/">Lesson 2.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 3</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit3/lesson3-1/">Lesson 3.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit3/lesson3-2/">Lesson 3.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit3/lesson3-3/">Lesson 3.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 4</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit4/lesson4-1/">Lesson 4.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit4/lesson4-2/">Lesson 4.2</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 5</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit5/lesson5-1/">Lesson 5.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit5/lesson5-2/">Lesson 5.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit5/lesson5-3/">Lesson 5.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 6</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="./">Lesson 6.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../lesson6-2/">Lesson 6.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../lesson6-3/">Lesson 6.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 7</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit7/lesson7-1/">Lesson 7.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit7/lesson7-2/">Lesson 7.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit7/lesson7-3/">Lesson 7.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 8</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit8/lesson8-1/">Lesson 8.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit8/lesson8-2/">Lesson 8.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit8/lesson8-3/">Lesson 8.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 9</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit9/lesson9-1/">Lesson 9.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit9/lesson9-2/">Lesson 9.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit9/lesson9-3/">Lesson 9.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 10</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit10/lesson10-1/">Lesson 10.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit10/lesson10-2/">Lesson 10.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit10/lesson10-3/">Lesson 10.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 11</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit11/lesson11-1/">Lesson 11.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit11/lesson11-2/">Lesson 11.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit11/lesson11-3/">Lesson 11.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                        </ul>
                    
                </li>
                
                <li >
                    
                        <a href="../../../test/" 
                           >
                            Terminal
                        </a>
                    
                </li>
                
            </ul>

            <div class="search-container">
                <input type="text" 
                       class="search-input" 
                       id="searchInput" 
                       placeholder="Search lessons..."
                       autocomplete="off">
                <span class="search-icon">üîç</span>
                <div class="search-results" id="searchResults"></div>
            </div>
        </div>
    </nav>

    <div class="container">
        
        <h1 id="network-traffic-analysis-with-wireshark">Network Traffic Analysis with Wireshark</h1>
<p>You've learned about networks, protocols, and security. Now it's time to see network traffic in action. <strong>Wireshark</strong> is the industry-standard tool for capturing and analyzing network packets. If you want to understand what's really happening on a network, you need to master Wireshark.</p>
<h2 id="what-is-wireshark">What is Wireshark?</h2>
<p><strong>Wireshark</strong> is a free, open-source packet analyzer. It captures network traffic in real-time and displays it in human-readable format. Think of it as a microscope for networks‚Äîit lets you examine every single packet flowing across the wire.</p>
<p>Security professionals use Wireshark to:
- Troubleshoot network issues
- Detect malicious activity
- Reverse engineer protocols
- Analyze malware communication
- Investigate security incidents
- Learn how protocols actually work
- Capture credentials (in authorized testing)
- Verify encryption is working</p>
<p>Wireshark is so powerful and essential that it's installed by default on Kali Linux and used daily by security professionals worldwide.</p>
<h2 id="understanding-packet-capture">Understanding Packet Capture</h2>
<p>Before we dive into Wireshark, let's understand what we're capturing.</p>
<h3 id="promiscuous-mode">Promiscuous Mode</h3>
<p>Normally, your network card only captures packets addressed to you. In <strong>promiscuous mode</strong>, your network card captures all packets on the network segment, regardless of destination. This is essential for security analysis but also why packet sniffing can be a privacy concern.</p>
<p>Note: On switched networks, you usually only see:
- Broadcast traffic
- Multicast traffic
- Traffic to/from your machine</p>
<p>To see other traffic, you'd need to be on a hub (rare today), use ARP poisoning to redirect traffic through your machine, or have access to network tap/SPAN port.</p>
<h3 id="capture-filters-vs-display-filters">Capture Filters vs. Display Filters</h3>
<p><strong>Capture filters</strong>: Applied during capture, determine what packets are saved. More efficient but can't be changed after capture.</p>
<p><strong>Display filters</strong>: Applied after capture, determine what you see. Can be changed anytime without recapturing.</p>
<p>Both use different syntax‚Äîcapture filters use BPF (Berkeley Packet Filter), display filters use Wireshark's own syntax.</p>
<h2 id="getting-started-with-wireshark">Getting Started with Wireshark</h2>
<h3 id="the-interface">The Interface</h3>
<p>When you open Wireshark, you see:
- <strong>Interface list</strong>: Network interfaces you can capture from
- <strong>Capture pane</strong>: Real-time packet list during capture
- <strong>Packet details pane</strong>: Expanded view of selected packet
- <strong>Packet bytes pane</strong>: Raw hexadecimal and ASCII data</p>
<h3 id="capturing-your-first-packets">Capturing Your First Packets</h3>
<ol>
<li>Select a network interface (usually your active connection)</li>
<li>Click the blue shark fin icon to start capture</li>
<li>Generate some traffic (visit a website)</li>
<li>Click the red square to stop capture</li>
<li>Examine the results</li>
</ol>
<p>Each row represents one packet with columns:
- <strong>No.</strong>: Packet number
- <strong>Time</strong>: When packet was captured
- <strong>Source</strong>: Source IP address
- <strong>Destination</strong>: Destination IP address
- <strong>Protocol</strong>: Protocol used (TCP, UDP, HTTP, etc.)
- <strong>Length</strong>: Packet size in bytes
- <strong>Info</strong>: Summary of packet contents</p>
<h3 id="understanding-the-packet-details">Understanding the Packet Details</h3>
<p>Click on any packet to see three views:</p>
<p><strong>Packet List</strong>: The summary row</p>
<p><strong>Packet Details</strong>: Expandable tree showing each protocol layer:
- Frame: Physical layer info
- Ethernet II: Data link layer (MAC addresses)
- Internet Protocol: Network layer (IP addresses)
- TCP/UDP: Transport layer (ports, flags)
- Application data: Whatever protocol is inside (HTTP, DNS, etc.)</p>
<p><strong>Packet Bytes</strong>: Raw data in hex and ASCII</p>
<p>This three-pane view is Wireshark's power‚Äîyou can see the same packet at different levels of detail.</p>
<h2 id="display-filters-finding-what-matters">Display Filters: Finding What Matters</h2>
<p>With thousands or millions of packets, you need to filter. Display filters are Wireshark's query language.</p>
<h3 id="basic-display-filter-syntax">Basic Display Filter Syntax</h3>
<p><strong>Filter by protocol:</strong></p>
<pre><code>http
tcp
dns
icmp
</code></pre>
<p><strong>Filter by IP address:</strong></p>
<pre><code>ip.addr == 192.168.1.1          # Any direction
ip.src == 192.168.1.1           # Source only
ip.dst == 192.168.1.1           # Destination only
</code></pre>
<p><strong>Filter by port:</strong></p>
<pre><code>tcp.port == 80                   # Any direction
tcp.srcport == 443              # Source port
tcp.dstport == 22               # Destination port
</code></pre>
<p><strong>Combine filters:</strong></p>
<pre><code>ip.addr == 192.168.1.1 &amp;&amp; tcp.port == 80
http || dns
tcp.port == 443 &amp;&amp; ip.src == 10.0.0.5
</code></pre>
<p><strong>Logical operators:</strong>
- <code>&amp;&amp;</code> or <code>and</code>: Both conditions must be true
- <code>||</code> or <code>or</code>: Either condition true
- <code>!</code> or <code>not</code>: Negation</p>
<h3 id="common-security-filters">Common Security Filters</h3>
<p><strong>Find login credentials (if not encrypted):</strong></p>
<pre><code>http.request.method == &quot;POST&quot;
ftp.request.command == &quot;PASS&quot;
</code></pre>
<p><strong>Find DNS queries:</strong></p>
<pre><code>dns.qry.name contains &quot;malicious&quot;
</code></pre>
<p><strong>Find TCP connections:</strong></p>
<pre><code>tcp.flags.syn == 1 &amp;&amp; tcp.flags.ack == 0
</code></pre>
<p><strong>Find specific HTTP methods:</strong></p>
<pre><code>http.request.method == &quot;POST&quot;
http.request.uri contains &quot;/admin&quot;
</code></pre>
<p><strong>Find errors:</strong></p>
<pre><code>http.response.code &gt;= 400
tcp.analysis.retransmission
</code></pre>
<p><strong>Find large packets (potential data exfiltration):</strong></p>
<pre><code>frame.len &gt; 1000
</code></pre>
<p><strong>Find suspicious user agents:</strong></p>
<pre><code>http.user_agent contains &quot;sqlmap&quot;
http.user_agent contains &quot;nikto&quot;
</code></pre>
<h2 id="analyzing-common-protocols">Analyzing Common Protocols</h2>
<h3 id="http-traffic">HTTP Traffic</h3>
<p>HTTP is unencrypted and reveals everything. Let's analyze an HTTP request:</p>
<pre><code>GET /index.html HTTP/1.1
Host: example.com
User-Agent: Mozilla/5.0
Accept: text/html
</code></pre>
<p>In Wireshark:
1. Filter for <code>http</code>
2. Find a GET request
3. Right-click ‚Üí Follow ‚Üí HTTP Stream
4. See the entire conversation in plain text</p>
<p>You can see:
- URLs visited
- Cookies
- Form data
- User agents
- Server responses</p>
<p><strong>Security note</strong>: This is why HTTPS is crucial. HTTP traffic is completely visible to anyone on the network.</p>
<h3 id="https-traffic">HTTPS Traffic</h3>
<p>HTTPS encrypts HTTP, so you'll see:
- TLS handshake (establishing encryption)
- Encrypted application data (unreadable)
- Certificate information (visible during handshake)</p>
<p>Filter: <code>tls</code> or <code>ssl</code></p>
<p>You can see:
- Which sites are visited (from SNI in Client Hello)
- IP addresses
- Certificate validity
- TLS version
- Cipher suites</p>
<p>But you can't see:
- Specific URLs
- Transmitted data
- Cookies or credentials</p>
<h3 id="dns-traffic">DNS Traffic</h3>
<p>DNS queries reveal a lot about user activity:</p>
<p>Filter: <code>dns</code></p>
<p>You can see:
- What domains are being resolved
- Response IP addresses
- Query types (A, AAAA, MX, TXT, etc.)</p>
<p><strong>Security uses:</strong>
- Detect DNS tunneling (data exfiltration through DNS)
- Find connections to known malicious domains
- Identify command and control traffic
- Spot DGA (Domain Generation Algorithm) patterns</p>
<p>Example filter for DNS queries only:</p>
<pre><code>dns.flags.response == 0
</code></pre>
<h3 id="tcp-three-way-handshake">TCP Three-Way Handshake</h3>
<p>Understanding TCP handshakes is fundamental:</p>
<ol>
<li><strong>SYN</strong>: Client ‚Üí Server (initiating connection)</li>
<li><strong>SYN-ACK</strong>: Server ‚Üí Client (acknowledging and returning SYN)</li>
<li><strong>ACK</strong>: Client ‚Üí Server (acknowledging server's SYN)</li>
</ol>
<p>Filter to see only handshakes:</p>
<pre><code>tcp.flags.syn == 1
</code></pre>
<p><strong>What this reveals:</strong>
- Which services are being accessed
- Successful vs. failed connections
- Port scanning activity (many SYNs, few ACKs)</p>
<h3 id="ftp-traffic-unencrypted-file-transfer">FTP Traffic (Unencrypted File Transfer)</h3>
<p>FTP sends credentials in plaintext:</p>
<p>Filter: <code>ftp</code></p>
<p>You'll see:
- USER command (username)
- PASS command (password in plain text!)
- File transfers
- Directory listings</p>
<p>Right-click a packet ‚Üí Follow ‚Üí TCP Stream to see the entire session.</p>
<p><strong>Security lesson</strong>: FTP is incredibly insecure. Use SFTP or FTPS instead.</p>
<h2 id="detecting-attacks-with-wireshark">Detecting Attacks with Wireshark</h2>
<h3 id="port-scanning">Port Scanning</h3>
<p><strong>SYN Scan</strong>: Many SYN packets to different ports, few responses</p>
<pre><code>tcp.flags.syn == 1 &amp;&amp; tcp.flags.ack == 0
</code></pre>
<p>Look for:
- Single source IP
- Many different destination ports
- High packet rate
- Many RST responses (closed ports)</p>
<h3 id="arp-spoofing">ARP Spoofing</h3>
<p><strong>ARP poisoning</strong> redirects traffic by lying about MAC addresses.</p>
<p>Filter: <code>arp</code></p>
<p>Look for:
- Duplicate IP addresses with different MACs
- Many ARP replies without corresponding requests
- Gratuitous ARP (announcements without requests)</p>
<p>Filter for duplicate IPs:</p>
<pre><code>arp.duplicate-address-detected
</code></pre>
<h3 id="malware-communication">Malware Communication</h3>
<p><strong>Indicators:</strong>
- Unusual ports
- Suspicious domains in DNS queries
- Regular beacon intervals (malware checking in)
- Large uploads (data exfiltration)
- Connections to known malicious IPs</p>
<p>Filter for beaconing (regular intervals):</p>
<pre><code>tcp &amp;&amp; frame.time_delta &gt; 60 &amp;&amp; frame.time_delta &lt; 61
</code></pre>
<h3 id="password-sniffing">Password Sniffing</h3>
<p>If credentials are sent unencrypted:</p>
<p><strong>HTTP authentication:</strong></p>
<pre><code>http.authbasic
</code></pre>
<p><strong>FTP passwords:</strong></p>
<pre><code>ftp.request.command == &quot;PASS&quot;
</code></pre>
<p><strong>Telnet login:</strong></p>
<pre><code>telnet &amp;&amp; tcp.port == 23
</code></pre>
<p>Right-click ‚Üí Follow Stream to see full credential exchange.</p>
<h2 id="advanced-wireshark-techniques">Advanced Wireshark Techniques</h2>
<h3 id="statistics-and-analysis">Statistics and Analysis</h3>
<p><strong>Protocol Hierarchy</strong>: Statistics ‚Üí Protocol Hierarchy
- Shows breakdown of all protocols in capture
- Identifies unusual traffic</p>
<p><strong>Conversations</strong>: Statistics ‚Üí Conversations
- Lists all pairs of communicating hosts
- Shows data transferred
- Identifies heavy users or data transfers</p>
<p><strong>I/O Graphs</strong>: Statistics ‚Üí I/O Graph
- Visualizes traffic over time
- Spots spikes or patterns
- Useful for DDoS analysis</p>
<h3 id="following-streams">Following Streams</h3>
<p>Right-click any packet ‚Üí Follow ‚Üí [protocol] Stream</p>
<p>Shows entire conversation in readable format. Works for:
- TCP Stream
- UDP Stream
- HTTP Stream
- TLS Stream (shows encrypted data)</p>
<h3 id="exporting-objects">Exporting Objects</h3>
<p>For HTTP/HTTPS captures: File ‚Üí Export Objects ‚Üí HTTP</p>
<p>Extracts all files transferred:
- Images
- JavaScript
- CSS
- Downloads
- Malware samples (be careful!)</p>
<h3 id="time-display-formats">Time Display Formats</h3>
<p>View ‚Üí Time Display Format
- Seconds since beginning of capture
- Absolute time
- Delta time (since previous packet)</p>
<p>Useful for identifying timing patterns.</p>
<h3 id="coloring-rules">Coloring Rules</h3>
<p>View ‚Üí Coloring Rules</p>
<p>Wireshark colors packets by default:
- Light blue: UDP
- Light purple: TCP
- Black: Errors
- Green: HTTP
- Light yellow: Windows-specific traffic</p>
<p>You can create custom rules:</p>
<pre><code>tcp.analysis.retransmission ‚Üí Red (possible network issues)
dns.qry.name contains &quot;malware&quot; ‚Üí Red (suspicious DNS)
</code></pre>
<h2 id="capturing-strategies">Capturing Strategies</h2>
<h3 id="targeted-capture">Targeted Capture</h3>
<p>Don't capture everything‚Äîbe specific:</p>
<p><strong>Capture filter for HTTP only:</strong></p>
<pre><code>port 80 or port 443
</code></pre>
<p><strong>Capture specific host:</strong></p>
<pre><code>host 192.168.1.100
</code></pre>
<p><strong>Capture subnet:</strong></p>
<pre><code>net 192.168.1.0/24
</code></pre>
<p><strong>Exclude broadcast noise:</strong></p>
<pre><code>not broadcast and not multicast
</code></pre>
<h3 id="ring-buffer-for-long-term-capture">Ring Buffer for Long-Term Capture</h3>
<p>For continuous monitoring:
1. Capture ‚Üí Options
2. Enable "Use multiple files"
3. Set ring buffer (e.g., 100 files of 10 MB each)
4. Wireshark automatically rotates files</p>
<h3 id="remote-capture">Remote Capture</h3>
<p>Capture on one machine, analyze on another:
1. Set up tcpdump on remote server
2. Pipe traffic to Wireshark on local machine</p>
<pre><code class="language-bash">ssh user@remote &quot;tcpdump -i eth0 -w -&quot; | wireshark -k -i -
</code></pre>
<h2 id="practical-scenarios">Practical Scenarios</h2>
<h3 id="scenario-1-investigating-slow-network">Scenario 1: Investigating Slow Network</h3>
<ol>
<li>Start capture on affected user's system</li>
<li>Reproduce the problem</li>
<li>Statistics ‚Üí Protocol Hierarchy</li>
<li>Look for unusual protocols or heavy usage</li>
<li>Check for retransmissions: <code>tcp.analysis.retransmission</code></li>
<li>Examine high-traffic conversations</li>
</ol>
<h3 id="scenario-2-suspected-data-exfiltration">Scenario 2: Suspected Data Exfiltration</h3>
<ol>
<li>Capture traffic from suspected system</li>
<li>Statistics ‚Üí Conversations ‚Üí sort by bytes</li>
<li>Look for large uploads to unusual destinations</li>
<li>Check DNS queries for suspicious domains</li>
<li>Follow streams to examine content</li>
<li>Export objects to find transferred files</li>
</ol>
<h3 id="scenario-3-malware-analysis">Scenario 3: Malware Analysis</h3>
<ol>
<li>Capture traffic in isolated VM</li>
<li>Execute malware sample</li>
<li>Stop capture after observable activity</li>
<li>Filter DNS queries: identify C2 domains</li>
<li>Filter HTTP/HTTPS: identify beacon patterns</li>
<li>Check for protocols on unusual ports</li>
<li>Export malware downloads</li>
</ol>
<h2 id="best-practices">Best Practices</h2>
<ol>
<li><strong>Capture with permission</strong>: Only on networks you own or have authorization</li>
<li><strong>Secure captures</strong>: Packet captures may contain sensitive data</li>
<li><strong>Use appropriate filters</strong>: Don't capture more than needed</li>
<li><strong>Save important captures</strong>: They're evidence</li>
<li><strong>Document findings</strong>: Note unusual patterns</li>
<li><strong>Practice regularly</strong>: Skills improve with use</li>
<li><strong>Stay updated</strong>: New protocols and attacks emerge constantly</li>
</ol>
<h2 id="legal-and-ethical-considerations">Legal and Ethical Considerations</h2>
<p><strong>Important</strong>: Packet capture can reveal:
- Passwords and credentials
- Private communications
- Financial information
- Medical records
- Trade secrets</p>
<p><strong>Rules:</strong>
- Only capture on networks you own or have written permission
- Don't capture in public Wi-Fi without authorization
- Treat captured data as highly sensitive
- Follow company security policies
- Understand local laws on network monitoring</p>
<p>In many jurisdictions, unauthorized packet capture is illegal wiretapping.</p>
<h2 id="tools-that-complement-wireshark">Tools That Complement Wireshark</h2>
<p><strong>tcpdump</strong>: Command-line packet capture (often used on servers)</p>
<pre><code class="language-bash">tcpdump -i eth0 -w capture.pcap port 80
</code></pre>
<p><strong>tshark</strong>: Command-line version of Wireshark (great for scripting)</p>
<pre><code class="language-bash">tshark -r capture.pcap -Y http.request -T fields -e http.host
</code></pre>
<p><strong>NetworkMiner</strong>: Extracts artifacts from pcap files
<strong>CapAnalysis</strong>: Web-based pcap analyzer
<strong>Zeek</strong> (formerly Bro): Network security monitoring platform</p>
<h2 id="whats-next">What's Next</h2>
<p>Wireshark is a skill that develops over time. Start by:
1. Capturing your own web browsing
2. Analyzing different protocols
3. Practicing with public pcap files
4. Participating in CTF challenges
5. Contributing to investigations</p>
<p>In upcoming lessons, we'll use Wireshark to analyze specific attack scenarios and learn how to detect sophisticated threats. Every security professional needs packet analysis skills‚Äîit's the ground truth of what's really happening on a network.</p>
<p>Keep practicing, and you'll develop an intuition for what's normal vs. suspicious in network traffic. That intuition is invaluable in cybersecurity.</p>
        

        <!-- Lesson Navigation (only show on non-homepage pages) -->
        
        <div class="lesson-nav">
            
            <a href="../../unit5/lesson5-3/" class="lesson-nav-button">
                <span class="arrow">‚Üê</span>
                <span>Previous: Lesson 5.3</span>
            </a>
            

            <div class="lesson-nav-info">
                <div class="current-lesson">Current Lesson</div>
                <div class="lesson-title">Lesson 6.1</div>
            </div>

            
            <a href="../lesson6-2/" class="lesson-nav-button">
                <span>Next: Lesson 6.2</span>
                <span class="arrow">‚Üí</span>
            </a>
            
        </div>
        
    </div>

    <footer>
        <p>NCHS Cybersecurity | Built with MkDocs</p>
        
        <p>Copyright &copy; 2025 Mohamed Morsy</p>
        
    </footer>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm@5.3.0/css/xterm.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/xterm@5.3.0/lib/xterm.min.js"></script>
    
    <script src="../../../search_index.js"></script>
    
    <script>
        function toggleMenu() {
            const navLinks = document.getElementById('navLinks');
            navLinks.classList.toggle('active');
        }

        document.addEventListener('DOMContentLoaded', function() {
            const unitHeaders = document.querySelectorAll('.nav-links .nested > strong');
            
            unitHeaders.forEach(header => {
                header.addEventListener('click', function(e) {
                    e.stopPropagation(); 
                    const parent = this.parentElement;
                    parent.classList.toggle('collapsed');
                });
            });
        });

        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('searchInput');
            const searchResults = document.getElementById('searchResults');
            
            if (!searchInput || !searchResults) {
                return;
            }
            
            let searchIndex = null;
            let useSimpleSearch = false;
            
            const simpleIndex = [
                
                    
                
                    
                        
                            
                                
                                {
                                    title: "Lesson 1.1",
                                    url: '../../unit1/lesson1-1/',
                                    path: 'Curriculum > Unit 1'
                                },
                                
                                {
                                    title: "Lesson 1.2",
                                    url: '../../unit1/lesson1-2/',
                                    path: 'Curriculum > Unit 1'
                                },
                                
                                {
                                    title: "Lesson 1.3",
                                    url: '../../unit1/lesson1-3/',
                                    path: 'Curriculum > Unit 1'
                                },
                                
                                {
                                    title: "Lesson 1.4",
                                    url: '../../unit1/lesson1-4/',
                                    path: 'Curriculum > Unit 1'
                                },
                                
                                {
                                    title: "Lesson 1.5",
                                    url: '../../unit1/lesson1-5/',
                                    path: 'Curriculum > Unit 1'
                                },
                                
                                {
                                    title: "Lesson 1.6",
                                    url: '../../unit1/lesson1-6/',
                                    path: 'Curriculum > Unit 1'
                                },
                                
                                {
                                    title: "Linux Installation Process",
                                    url: '../../unit1/installation-process/',
                                    path: 'Curriculum > Unit 1'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 2.1",
                                    url: '../../unit2/lesson2-1/',
                                    path: 'Curriculum > Unit 2'
                                },
                                
                                {
                                    title: "Lesson 2.2",
                                    url: '../../unit2/lesson2-2/',
                                    path: 'Curriculum > Unit 2'
                                },
                                
                                {
                                    title: "Lesson 2.3",
                                    url: '../../unit2/lesson2-3/',
                                    path: 'Curriculum > Unit 2'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 3.1",
                                    url: '../../unit3/lesson3-1/',
                                    path: 'Curriculum > Unit 3'
                                },
                                
                                {
                                    title: "Lesson 3.2",
                                    url: '../../unit3/lesson3-2/',
                                    path: 'Curriculum > Unit 3'
                                },
                                
                                {
                                    title: "Lesson 3.3",
                                    url: '../../unit3/lesson3-3/',
                                    path: 'Curriculum > Unit 3'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 4.1",
                                    url: '../../unit4/lesson4-1/',
                                    path: 'Curriculum > Unit 4'
                                },
                                
                                {
                                    title: "Lesson 4.2",
                                    url: '../../unit4/lesson4-2/',
                                    path: 'Curriculum > Unit 4'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 5.1",
                                    url: '../../unit5/lesson5-1/',
                                    path: 'Curriculum > Unit 5'
                                },
                                
                                {
                                    title: "Lesson 5.2",
                                    url: '../../unit5/lesson5-2/',
                                    path: 'Curriculum > Unit 5'
                                },
                                
                                {
                                    title: "Lesson 5.3",
                                    url: '../../unit5/lesson5-3/',
                                    path: 'Curriculum > Unit 5'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 6.1",
                                    url: './',
                                    path: 'Curriculum > Unit 6'
                                },
                                
                                {
                                    title: "Lesson 6.2",
                                    url: '../lesson6-2/',
                                    path: 'Curriculum > Unit 6'
                                },
                                
                                {
                                    title: "Lesson 6.3",
                                    url: '../lesson6-3/',
                                    path: 'Curriculum > Unit 6'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 7.1",
                                    url: '../../unit7/lesson7-1/',
                                    path: 'Curriculum > Unit 7'
                                },
                                
                                {
                                    title: "Lesson 7.2",
                                    url: '../../unit7/lesson7-2/',
                                    path: 'Curriculum > Unit 7'
                                },
                                
                                {
                                    title: "Lesson 7.3",
                                    url: '../../unit7/lesson7-3/',
                                    path: 'Curriculum > Unit 7'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 8.1",
                                    url: '../../unit8/lesson8-1/',
                                    path: 'Curriculum > Unit 8'
                                },
                                
                                {
                                    title: "Lesson 8.2",
                                    url: '../../unit8/lesson8-2/',
                                    path: 'Curriculum > Unit 8'
                                },
                                
                                {
                                    title: "Lesson 8.3",
                                    url: '../../unit8/lesson8-3/',
                                    path: 'Curriculum > Unit 8'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 9.1",
                                    url: '../../unit9/lesson9-1/',
                                    path: 'Curriculum > Unit 9'
                                },
                                
                                {
                                    title: "Lesson 9.2",
                                    url: '../../unit9/lesson9-2/',
                                    path: 'Curriculum > Unit 9'
                                },
                                
                                {
                                    title: "Lesson 9.3",
                                    url: '../../unit9/lesson9-3/',
                                    path: 'Curriculum > Unit 9'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 10.1",
                                    url: '../../unit10/lesson10-1/',
                                    path: 'Curriculum > Unit 10'
                                },
                                
                                {
                                    title: "Lesson 10.2",
                                    url: '../../unit10/lesson10-2/',
                                    path: 'Curriculum > Unit 10'
                                },
                                
                                {
                                    title: "Lesson 10.3",
                                    url: '../../unit10/lesson10-3/',
                                    path: 'Curriculum > Unit 10'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 11.1",
                                    url: '../../unit11/lesson11-1/',
                                    path: 'Curriculum > Unit 11'
                                },
                                
                                {
                                    title: "Lesson 11.2",
                                    url: '../../unit11/lesson11-2/',
                                    path: 'Curriculum > Unit 11'
                                },
                                
                                {
                                    title: "Lesson 11.3",
                                    url: '../../unit11/lesson11-3/',
                                    path: 'Curriculum > Unit 11'
                                },
                                
                            
                        
                    
                
                    
                        {
                            title: "Terminal",
                            url: '../../../test/',
                            path: 'Main'
                        },
                    
                
            ];
            
            if (typeof window.searchIndex !== 'undefined') {
                searchIndex = window.searchIndex;
                useSimpleSearch = false;
                console.log('‚úì Using embedded search index:', searchIndex.docs.length, 'documents');
            } else {
                const base_url = document.querySelector('base')?.getAttribute('href') || '/';
                fetch(base_url + 'search_data.js')
                    .then(response => response.text())
                    .then(data => {
                        eval(data);  
                        if (window.searchIndex) {
                            searchIndex = window.searchIndex;
                            useSimpleSearch = false;
                            console.log('‚úì Loaded search index from JS:', searchIndex.docs.length, 'documents');
                        }
                    })
                    .catch(() => {
                        console.log('Using simple title search (full search not available)');
                        useSimpleSearch = true;
                    });
                
                useSimpleSearch = true; 
            }
            
            function performSearch(query) {
                if (!query || query.length < 2) {
                    searchResults.classList.remove('active');
                    return;
                }
                
                if (useSimpleSearch || !searchIndex) {
                    performSimpleSearch(query);
                } else {
                    performFullSearch(query);
                }
            }
            
            function performSimpleSearch(query) {
                const lowerQuery = query.toLowerCase();
                const results = simpleIndex.filter(item => 
                    item.title.toLowerCase().includes(lowerQuery)
                );
                displaySimpleResults(results, query);
            }
            
            function performFullSearch(query) {
                const lowerQuery = query.toLowerCase();
                const queryTerms = lowerQuery.split(/\s+/);
                
                const results = searchIndex.docs
                    .map(doc => {
                        let score = 0;
                        let matchedText = '';
                        
                        if (doc.title && doc.title.toLowerCase().includes(lowerQuery)) {
                            score += 10;
                        }
                        
                        if (doc.text) {
                            const text = doc.text.toLowerCase();
                            queryTerms.forEach(term => {
                                if (term.length < 2) return;
                                const count = (text.match(new RegExp(escapeRegex(term), 'g')) || []).length;
                                score += count;
                                
                                if (count > 0 && !matchedText) {
                                    const index = text.indexOf(term);
                                    const start = Math.max(0, index - 50);
                                    const end = Math.min(text.length, index + term.length + 50);
                                    matchedText = doc.text.substring(start, end);
                                    if (start > 0) matchedText = '...' + matchedText;
                                    if (end < text.length) matchedText = matchedText + '...';
                                }
                            });
                        }
                        
                        return {
                            title: doc.title,
                            location: doc.location,
                            text: matchedText || (doc.text ? doc.text.substring(0, 150) + '...' : ''),
                            score: score
                        };
                    })
                    .filter(result => result.score > 0)
                    .sort((a, b) => b.score - a.score);
                
                displayFullResults(results, query);
            }
            
            function displaySimpleResults(results, query) {
                if (results.length === 0) {
                    searchResults.innerHTML = '<div class="search-no-results">No results found</div>';
                    searchResults.classList.add('active');
                    return;
                }
                
                const html = results.slice(0, 10).map(result => {
                    const highlightedTitle = highlightText(result.title, query);
                    return `
                        <a href="${result.url}" class="search-result-item">
                            <div class="search-result-title">${highlightedTitle}</div>
                            <div class="search-result-path">${escapeHtml(result.path)}</div>
                        </a>
                    `;
                }).join('');
                
                searchResults.innerHTML = html;
                searchResults.classList.add('active');
            }
            
            function displayFullResults(results, query) {
                if (results.length === 0) {
                    searchResults.innerHTML = '<div class="search-no-results">No results found</div>';
                    searchResults.classList.add('active');
                    return;
                }
                
                const pathname = window.location.pathname;
                let basePath = '/';
                
                const pathParts = pathname.split('/').filter(p => p);
                
                if (pathParts.length > 0 && !pathParts[0].endsWith('.html')) {
                    const firstPart = pathParts[0];
                    if (firstPart !== 'index' && firstPart !== 'search') {
                        basePath = '/' + firstPart + '/';
                    }
                }
                
                console.log('Current pathname:', pathname);
                console.log('Detected base path:', basePath);
                
                const html = results.slice(0, 10).map(result => {
                    const highlightedTitle = highlightText(result.title, query);
                    const highlightedText = highlightText(result.text, query);
                    
                    let path = result.location.replace(/^\//, '').replace(/\.html$/, '').replace(/\//g, ' > ');
                    if (!path) path = 'Home';
                    
                    let url;
                    if (basePath === '/') {
                        url = result.location;
                    } else {
                        const cleanLocation = result.location.startsWith('/') ? result.location.substring(1) : result.location;
                        url = basePath + cleanLocation;
                    }
                    
                    console.log('Result:', result.title, '-> URL:', url);
                    
                    return `
                        <a href="${url}" class="search-result-item">
                            <div class="search-result-title">${highlightedTitle}</div>
                            <div class="search-result-path">${escapeHtml(path)}</div>
                            <div class="search-result-excerpt">${highlightedText}</div>
                        </a>
                    `;
                }).join('');
                
                searchResults.innerHTML = html;
                searchResults.classList.add('active');
            }
            
            function highlightText(text, query) {
                if (!text) return '';
                const queryTerms = query.split(/\s+/).filter(t => t.length >= 2);
                let result = escapeHtml(text);
                queryTerms.forEach(term => {
                    const regex = new RegExp('(' + escapeRegex(term) + ')', 'gi');
                    result = result.replace(regex, '<span class="search-highlight">$1</span>');
                });
                return result;
            }
            
            function escapeRegex(string) {
                return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
            }
            
            function escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
            
            let searchTimeout;
            searchInput.addEventListener('input', function(e) {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => performSearch(e.target.value), 300);
            });
            
            searchInput.addEventListener('focus', function(e) {
                if (e.target.value.length >= 2) {
                    performSearch(e.target.value);
                }
            });
            
            document.addEventListener('click', function(e) {
                if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
                    searchResults.classList.remove('active');
                }
            });
            
            searchInput.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    searchResults.classList.remove('active');
                    searchInput.blur();
                }
            });
        });

        
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('pre code').forEach((block) => {
                block.parentElement.style.position = 'relative';
            });
        });
        
    </script>
</body>
</html>